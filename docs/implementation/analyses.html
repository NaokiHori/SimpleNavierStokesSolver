
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>analyses.c &#8212; Simple Navier-Stokes Solver 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"der": ["{\\frac{\\partial #1}{\\partial #2}}", 2], "dder": ["{\\frac{\\delta #1}{\\delta #2}}", 2], "mst": ["{\\gamma^{#1 #2}}", 2], "gx": ["{\\xi}"], "gy": ["{\\eta}"], "ux": ["{u_x}"], "uy": ["{u_y}"], "intrp": ["{\\overline{#1}^{#2}}", 2], "diffe": ["{\\delta_{#2} {#1}}", 2], "vat": ["{\\left. {#1} \\right|_{#2}}", 2], "ave": ["{\\left\\langle {#1} \\right\\rangle_{#2}}", 2], "pimm": ["i-1           "], "pim": ["i-\\frac{1}{2}"], "pic": ["i             "], "pip": ["i+\\frac{1}{2}"], "pipp": ["i+1           "], "pjmm": ["j-1           "], "pjm": ["j-\\frac{1}{2}"], "pjc": ["j             "], "pjp": ["j+\\frac{1}{2}"], "pjpp": ["j+1           "], "ximm": ["i-\\frac{1}{2}"], "xim": ["i             "], "xic": ["i+\\frac{1}{2}"], "xip": ["i+1           "], "xipp": ["i+\\frac{3}{2}"], "xjmm": ["j-1           "], "xjm": ["j-\\frac{1}{2}"], "xjc": ["j             "], "xjp": ["j+\\frac{1}{2}"], "xjpp": ["j+1           "], "yimm": ["i-1           "], "yim": ["i-\\frac{1}{2}"], "yic": ["i             "], "yip": ["i+\\frac{1}{2}"], "yipp": ["i+1           "], "yjmm": ["j-\\frac{1}{2}"], "yjm": ["j             "], "yjc": ["j+\\frac{1}{2}"], "yjp": ["j+1           "], "yjpp": ["j+\\frac{3}{2}"], "dintrpa": ["{\\overline{#1}^{#2}}", 2], "dintrpv": ["{\\widehat {#1}^{#2}}", 2], "dintrpu": ["{\\widetilde {#1}^{#2}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="common.c" href="common.html" />
    <link rel="prev" title="Implementation" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Simple Navier-Stokes Solver</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NaokiHori&repo=SimpleNavierStokesSolver&type=true&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../governing_equations/index.html">Governing equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numerical_method/index.html">Numerical method</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Implementation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">analyses.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="common.html">common.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="fileio/main.html">fileio.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluid/index.html">fluid/</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">linalg.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">logging.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="main.html">main.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel/index.html">parallel/</a></li>
<li class="toctree-l2"><a class="reference internal" href="param/index.html">param/</a></li>
<li class="toctree-l2"><a class="reference internal" href="save.html">save.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="simple_npyio.html">simple_npy_io.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics/index.html">statistics/</a></li>
<li class="toctree-l2"><a class="reference internal" href="temperature/index.html">temperature/</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Implementation</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Implementation</a></li>
      <li>Next: <a href="common.html" title="next chapter">common.c</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="analyses">
<span id="id1"></span><h1><a class="reference external" href="https://github.com/NaokiHori/SimpleNavierStokesSolver/blob/main/src/analyses.c">analyses.c</a><a class="headerlink" href="#analyses" title="Permalink to this heading">¶</a></h1>
<p>Functions used to compute dissipation rates are included.</p>
<section id="analyses-compute-kinetic-dissipation">
<h2>analyses_compute_kinetic_dissipation<a class="headerlink" href="#analyses-compute-kinetic-dissipation" title="Permalink to this heading">¶</a></h2>
<section id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="nf">analyses_compute_kinetic_dissipation_x</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">param_t</span><span class="w"> </span><span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">fluid_t</span><span class="w"> </span><span class="o">*</span><span class="n">fluid</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="kt">double</span><span class="w"> </span><span class="nf">analyses_compute_kinetic_dissipation_y</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">param_t</span><span class="w"> </span><span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">fluid_t</span><span class="w"> </span><span class="o">*</span><span class="n">fluid</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>intent</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>param</p></td>
<td><p>in</p></td>
<td><p>general parameters</p></td>
</tr>
<tr class="row-odd"><td><p>fluid</p></td>
<td><p>in</p></td>
<td><p>velocity</p></td>
</tr>
<tr class="row-even"><td><p>i, j</p></td>
<td><p>in</p></td>
<td><p>indices</p></td>
</tr>
<tr class="row-odd"><td><p>data</p></td>
<td><p>out</p></td>
<td><p>kinetic dissipation rate</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h3>
<p>As being discussed in <a class="reference internal" href="../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a>, instantaneous and local kinetic dissipation (in non-dimensional form) <span class="math notranslate nohighlight">\(\epsilon_{k}\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[\epsilon_{k}
=
\frac{\sqrt{Pr}}{\sqrt{Ra}} \der{u_i}{x_j} \der{u_i}{x_j}.\]</div>
<p>As being derived in <a class="reference internal" href="../numerical_method/spatial_discretisation/discrete_governing_equations/momentum_balance_and_quadratic_quantity.html#momentum-balance"><span class="std std-ref">the discrete momentum balance and quadratic quantity</span></a>, the discrete form of <span class="math notranslate nohighlight">\(\der{u_i}{x_j} \der{u_i}{x_j}\)</span>:</p>
<div class="math notranslate nohighlight">
\[s_{xx} s_{xx}
+
s_{xy} s_{xy}
+
s_{yx} s_{yx}
+
s_{yy} s_{yy}\]</div>
<p>is twofold,</p>
<div class="math notranslate nohighlight">
\[\begin{split}s_{xj} s_{xj}
&amp; =
s_{xx} s_{xx}
+
s_{xy} s_{xy} \\
&amp; =
\frac{1}{2}
\frac{1}{\Delta x_{\xic}}
\vat{
   \diffe{\ux}{x}
}{\xip, \xjc}
\vat{
   \dder{\ux}{x}
}{\xip, \xjc}
+
\frac{1}{2}
\frac{1}{\Delta x_{\xic}}
\vat{
   \diffe{\ux}{x}
}{\xim, \xjc}
\vat{
   \dder{\ux}{x}
}{\xim, \xjc} \\
&amp; +
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\ux}{y}
}{\xic, \xjp}
\vat{
   \dder{\ux}{y}
}{\xic, \xjp}
+
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\ux}{y}
}{\xic, \xjm}
\vat{
   \dder{\ux}{y}
}{\xic, \xjm}\end{split}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>, and</p>
<div class="math notranslate nohighlight">
\[\begin{split}s_{yj} s_{yj}
&amp; =
s_{yx} s_{yx}
+
s_{yy} s_{yy} \\
&amp; =
\vat{C}{\yip}
\frac{1}{\Delta x_{\yic}}
\vat{
   \diffe{\uy}{x}
}{\yip, \yjc}
\vat{
   \dder{\uy}{x}
}{\yip, \yjc}
+
\vat{C}{\yim}
\frac{1}{\Delta x_{\yic}}
\vat{
   \diffe{\uy}{x}
}{\yim, \yjc}
\vat{
   \dder{\uy}{x}
}{\yim, \yjc} \\
&amp; +
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\uy}{y}
}{\yic, \yjp}
\vat{
   \dder{\uy}{y}
}{\yic, \yjp}
+
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\uy}{y}
}{\yic, \yjm}
\vat{
   \dder{\uy}{y}
}{\yic, \yjm}\end{split}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>, where <span class="math notranslate nohighlight">\(\vat{C}{\pip}, \vat{C}{\pim}\)</span> are coefficients</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\vat{C}{\pip}
=
\begin{cases}
   \pip \text{is right wall} &amp; 1 \\
   \text{otherwise}          &amp; \frac{1}{2}
\end{cases}, \\
&amp;
\vat{C}{\pim}
=
\begin{cases}
   \pim \text{is left wall} &amp; 1 \\
   \text{otherwise}         &amp; \frac{1}{2}
\end{cases}.\end{split}\]</div>
<p>Contributions of <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span> should be computed at different locations, which are taken care of by <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">analyses_compute_kinetic_dissipation_x</span><span class="w"></span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">17</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sxjsxj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"></span>
<span class="linenos">18</span><span class="w">  </span><span class="c1">// left-cell contribution</span>
<span class="linenos">19</span><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="w"></span>
<span class="linenos">20</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dux</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">21</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duxdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dux</span><span class="o">/</span><span class="n">DXF</span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="linenos">22</span><span class="w">    </span><span class="n">sxjsxj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">DXC</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dux</span><span class="o">*</span><span class="n">duxdx</span><span class="p">;</span><span class="w"></span>
<span class="linenos">23</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">24</span><span class="w">  </span><span class="c1">// right-cell contribution</span>
<span class="linenos">25</span><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">itot</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span><span class="w"></span>
<span class="linenos">26</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dux</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">27</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duxdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dux</span><span class="o">/</span><span class="n">DXF</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">28</span><span class="w">    </span><span class="n">sxjsxj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">DXC</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dux</span><span class="o">*</span><span class="n">duxdx</span><span class="p">;</span><span class="w"></span>
<span class="linenos">29</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">30</span><span class="w">  </span><span class="c1">// bottom-cell contribution</span>
<span class="linenos">31</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">32</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dux</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="linenos">33</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duxdy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dux</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">34</span><span class="w">    </span><span class="n">sxjsxj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">dy</span><span class="o">*</span><span class="n">dux</span><span class="o">*</span><span class="n">duxdy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">35</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">36</span><span class="w">  </span><span class="c1">// top-cell contribution</span>
<span class="linenos">37</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">38</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dux</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">UX</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">39</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duxdy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dux</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">40</span><span class="w">    </span><span class="n">sxjsxj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">dy</span><span class="o">*</span><span class="n">dux</span><span class="o">*</span><span class="n">duxdy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">41</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">42</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pr</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ra</span><span class="p">)</span><span class="o">*</span><span class="n">sxjsxj</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>and <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">analyses_compute_kinetic_dissipation_y</span><span class="w"></span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">54</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">syjsyj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"></span>
<span class="linenos">55</span><span class="w">  </span><span class="c1">// left-cell contribution</span>
<span class="linenos">56</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">57</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"></span>
<span class="linenos">58</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duy</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">59</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duydx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">duy</span><span class="o">/</span><span class="n">DXC</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">60</span><span class="w">    </span><span class="n">syjsyj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="o">/</span><span class="n">DXF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">duy</span><span class="o">*</span><span class="n">duydx</span><span class="p">;</span><span class="w"></span>
<span class="linenos">61</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">62</span><span class="w">  </span><span class="c1">// right-cell contribution</span>
<span class="linenos">63</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">64</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">itot</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"></span>
<span class="linenos">65</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duy</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">66</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duydx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">duy</span><span class="o">/</span><span class="n">DXC</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="linenos">67</span><span class="w">    </span><span class="n">syjsyj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="o">/</span><span class="n">DXF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">duy</span><span class="o">*</span><span class="n">duydx</span><span class="p">;</span><span class="w"></span>
<span class="linenos">68</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">69</span><span class="w">  </span><span class="c1">// bottom-cell contribution</span>
<span class="linenos">70</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">71</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duy</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="linenos">72</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duydy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">duy</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">73</span><span class="w">    </span><span class="n">syjsyj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">dy</span><span class="o">*</span><span class="n">duy</span><span class="o">*</span><span class="n">duydy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">74</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">75</span><span class="w">  </span><span class="c1">// top-cell contribution</span>
<span class="linenos">76</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">77</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duy</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">UY</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">78</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">duydy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">duy</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">79</span><span class="w">    </span><span class="n">syjsyj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">dy</span><span class="o">*</span><span class="n">duy</span><span class="o">*</span><span class="n">duydy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">80</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">81</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pr</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ra</span><span class="p">)</span><span class="o">*</span><span class="n">syjsyj</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What we compute here is the integrand of</p>
<div class="math notranslate nohighlight">
\[\int \epsilon_k dV
\approx
\sum \color{red}{\epsilon_k} \Delta x \Delta y.\]</div>
<p>Thus, in order to obtain volume-integrated value, we need to multiply the result by the cell size <span class="math notranslate nohighlight">\(\Delta x \Delta y\)</span>.</p>
</div>
</section>
</section>
<section id="analyses-compute-thermal-dissipation">
<h2>analyses_compute_thermal_dissipation<a class="headerlink" href="#analyses-compute-thermal-dissipation" title="Permalink to this heading">¶</a></h2>
<section id="id2">
<h3>Definition<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">analyses_compute_thermal_dissipation</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">param_t</span><span class="w"> </span><span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">parallel_t</span><span class="w"> </span><span class="o">*</span><span class="n">parallel</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">fluid_t</span><span class="w"> </span><span class="o">*</span><span class="n">fluid</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>intent</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>param</p></td>
<td><p>in</p></td>
<td><p>general parameters</p></td>
</tr>
<tr class="row-odd"><td><p>parallel</p></td>
<td><p>in</p></td>
<td><p>MPI parameters</p></td>
</tr>
<tr class="row-even"><td><p>temperature</p></td>
<td><p>in</p></td>
<td><p>temperature</p></td>
</tr>
<tr class="row-odd"><td><p>data</p></td>
<td><p>out</p></td>
<td><p>thermal dissipation rate</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id3">
<h3>Description<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>As being discussed in <a class="reference internal" href="../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a>, instantaneous and local thermal dissipation (in non-dimensional form) <span class="math notranslate nohighlight">\(\epsilon_{h}\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[\epsilon_{h}
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \der{T}{x_i} \der{T}{x_i}.\]</div>
<p>As being derived in <a class="reference internal" href="../numerical_method/spatial_discretisation/discrete_governing_equations/thermal_energy_balance_and_quadratic_quantity.html#thermal-energy-balance"><span class="std std-ref">the thermal energy balance and quadratic quantity</span></a>, the discrete form of <span class="math notranslate nohighlight">\(\der{T}{x_i} \der{T}{x_i}\)</span>:</p>
<div class="math notranslate nohighlight">
\[r_x r_x
+
r_y r_y\]</div>
<p>leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\vat{C}{\pip}
\frac{1}{\Delta x_{\pic}}
\vat{
   \diffe{T}{x}
}{\pip, \pjc}
\vat{
   \dder{T}{x}
}{\pip, \pjc}
+
\vat{C}{\pim}
\frac{1}{\Delta x_{\pic}}
\vat{
   \diffe{T}{x}
}{\pim, \pjc}
\vat{
   \dder{T}{x}
}{\pim, \pjc} \\
+ &amp;
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{T}{y}
}{\pic, \pjp}
\vat{
   \dder{T}{y}
}{\pic, \pjp}
+
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{T}{y}
}{\pic, \pjm}
\vat{
   \dder{T}{y}
}{\pic, \pjm},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\vat{C}{\pip}, \vat{C}{\pim}\)</span> are coefficients</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\vat{C}{\pip}
=
\begin{cases}
   \pip \text{is right wall} &amp; 1 \\
   \text{otherwise}          &amp; \frac{1}{2}
\end{cases}, \\
&amp;
\vat{C}{\pim}
=
\begin{cases}
   \pim \text{is left wall} &amp; 1 \\
   \text{otherwise}         &amp; \frac{1}{2}
\end{cases}.\end{split}\]</div>
<p>The implementation leads</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 93</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">riri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 94</span><span class="w">  </span><span class="c1">// left-cell contribution</span>
<span class="linenos"> 95</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 96</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 97</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtemp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 98</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtempdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtemp</span><span class="o">/</span><span class="n">DXC</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 99</span><span class="w">    </span><span class="n">riri</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="o">/</span><span class="n">DXF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dtemp</span><span class="o">*</span><span class="n">dtempdx</span><span class="p">;</span><span class="w"></span>
<span class="linenos">100</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">101</span><span class="w">  </span><span class="c1">// right-cell contribution</span>
<span class="linenos">102</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">103</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">itot</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"></span>
<span class="linenos">104</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtemp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">105</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtempdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtemp</span><span class="o">/</span><span class="n">DXC</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="linenos">106</span><span class="w">    </span><span class="n">riri</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="o">/</span><span class="n">DXF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dtemp</span><span class="o">*</span><span class="n">dtempdx</span><span class="p">;</span><span class="w"></span>
<span class="linenos">107</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">108</span><span class="w">  </span><span class="c1">// bottom-cell contribution</span>
<span class="linenos">109</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">110</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtemp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">)</span><span class="o">-</span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="linenos">111</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtempdy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtemp</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">112</span><span class="w">    </span><span class="n">riri</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">dy</span><span class="o">*</span><span class="n">dtemp</span><span class="o">*</span><span class="n">dtempdy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">113</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">114</span><span class="w">  </span><span class="c1">// top-cell contribution</span>
<span class="linenos">115</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos">116</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtemp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">TEMP</span><span class="p">(</span><span class="n">i</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="linenos">117</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtempdy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtemp</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">118</span><span class="w">    </span><span class="n">riri</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">dy</span><span class="o">*</span><span class="n">dtemp</span><span class="o">*</span><span class="n">dtempdy</span><span class="p">;</span><span class="w"></span>
<span class="linenos">119</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">120</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pr</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ra</span><span class="p">)</span><span class="o">*</span><span class="n">riri</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What we compute here is the integrand of</p>
<div class="math notranslate nohighlight">
\[\int \epsilon_h dV
\approx
\sum \color{red}{\epsilon_h} \Delta x \Delta y.\]</div>
<p>Thus, in order to obtain volume-integrated value, we need to multiply the result by the cell size <span class="math notranslate nohighlight">\(\Delta x \Delta y\)</span>.</p>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Naoki Hori.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/implementation/analyses.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>