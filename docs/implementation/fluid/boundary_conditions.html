
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>fluid/boundary_conditions.c &#8212; Simple Navier-Stokes Solver 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"der": ["{\\frac{\\partial #1}{\\partial #2}}", 2], "dder": ["{\\frac{\\delta #1}{\\delta #2}}", 2], "mst": ["{\\gamma^{#1 #2}}", 2], "gx": ["{\\xi}"], "gy": ["{\\eta}"], "ux": ["{u_x}"], "uy": ["{u_y}"], "intrp": ["{\\overline{#1}^{#2}}", 2], "diffe": ["{\\delta_{#2} {#1}}", 2], "vat": ["{\\left. {#1} \\right|_{#2}}", 2], "ave": ["{\\left\\langle {#1} \\right\\rangle_{#2}}", 2], "pimm": ["i-1           "], "pim": ["i-\\frac{1}{2}"], "pic": ["i             "], "pip": ["i+\\frac{1}{2}"], "pipp": ["i+1           "], "pjmm": ["j-1           "], "pjm": ["j-\\frac{1}{2}"], "pjc": ["j             "], "pjp": ["j+\\frac{1}{2}"], "pjpp": ["j+1           "], "ximm": ["i-\\frac{1}{2}"], "xim": ["i             "], "xic": ["i+\\frac{1}{2}"], "xip": ["i+1           "], "xipp": ["i+\\frac{3}{2}"], "xjmm": ["j-1           "], "xjm": ["j-\\frac{1}{2}"], "xjc": ["j             "], "xjp": ["j+\\frac{1}{2}"], "xjpp": ["j+1           "], "yimm": ["i-1           "], "yim": ["i-\\frac{1}{2}"], "yic": ["i             "], "yip": ["i+\\frac{1}{2}"], "yipp": ["i+1           "], "yjmm": ["j-\\frac{1}{2}"], "yjm": ["j             "], "yjc": ["j+\\frac{1}{2}"], "yjp": ["j+1           "], "yjpp": ["j+\\frac{3}{2}"], "dintrpa": ["{\\overline{#1}^{#2}}", 2], "dintrpv": ["{\\widehat {#1}^{#2}}", 2], "dintrpu": ["{\\widetilde {#1}^{#2}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="fluid/compute_potential.c" href="compute_potential.html" />
    <link rel="prev" title="fluid/" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Simple Navier-Stokes Solver</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NaokiHori&repo=SimpleNavierStokesSolver&type=true&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governing_equations/index.html">Governing equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numerical_method/index.html">Numerical method</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Implementation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analyses.html">analyses.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common.html">common.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fileio/main.html">fileio.c</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">fluid/</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg.html">linalg.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">logging.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html">main.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel/index.html">parallel/</a></li>
<li class="toctree-l2"><a class="reference internal" href="../param/index.html">param/</a></li>
<li class="toctree-l2"><a class="reference internal" href="../save.html">save.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simple_npyio.html">simple_npy_io.c</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statistics/index.html">statistics/</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temperature/index.html">temperature/</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Implementation</a><ul>
  <li><a href="index.html">fluid/</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">fluid/</a></li>
      <li>Next: <a href="compute_potential.html" title="next chapter">fluid/compute_potential.c</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="fluid-boundary-conditions">
<span id="id1"></span><h1><a class="reference external" href="https://github.com/NaokiHori/SimpleNavierStokesSolver/blob/main/src/fluid/boundary_conditions.c">fluid/boundary_conditions.c</a><a class="headerlink" href="#fluid-boundary-conditions" title="Permalink to this heading">¶</a></h1>
<p>Update boundary values (boundary condition, halo cells) of the velocity and pressure fields.</p>
<section id="fluid-update-boundaries-ux">
<h2>fluid_update_boundaries_ux<a class="headerlink" href="#fluid-update-boundaries-ux" title="Permalink to this heading">¶</a></h2>
<section id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">fluid_update_boundaries_ux</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">param_t</span><span class="w"> </span><span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">parallel_t</span><span class="w"> </span><span class="o">*</span><span class="n">parallel</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ux</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>intent</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>param</p></td>
<td><p>in</p></td>
<td><p>general parameters</p></td>
</tr>
<tr class="row-odd"><td><p>parallel</p></td>
<td><p>in</p></td>
<td><p>MPI parameters</p></td>
</tr>
<tr class="row-even"><td><p>ux</p></td>
<td><p>out</p></td>
<td><p>x direction velocity</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h3>
<p>Since the domain is wall-bounded in <span class="math notranslate nohighlight">\(x\)</span> direction, impermeable condition is imposed on the <cite>x</cite> boundaries:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">16</span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">jsize</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="linenos">17</span><span class="w">    </span><span class="n">UX</span><span class="p">(</span><span class="w">     </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="c1">// impermeable</span>
<span class="linenos">18</span><span class="w">    </span><span class="n">UX</span><span class="p">(</span><span class="n">itot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="c1">// impermeable</span>
<span class="linenos">19</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Also halo cells are communicated here:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">13</span><span class="w">  </span><span class="n">parallel_update_halo_ym</span><span class="p">(</span><span class="n">parallel</span><span class="p">,</span><span class="w"> </span><span class="n">itot</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">jsize</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w">       </span><span class="mi">0</span><span class="p">));</span><span class="w"></span>
<span class="linenos">14</span><span class="w">  </span><span class="n">parallel_update_halo_yp</span><span class="p">(</span><span class="n">parallel</span><span class="p">,</span><span class="w"> </span><span class="n">itot</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w">     </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">jsize</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<p>where <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">parallel_update_halo_ym</span><span class="w"></span></code> is responsible for the communication with the lower process:</p>
<a class="reference internal image-reference" href="../../_images/boundary_conditions1.pdf"><img alt="../../_images/boundary_conditions1.pdf" src="../../_images/boundary_conditions1.pdf" style="width: 800px;" /></a>
<p>while <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">parallel_update_halo_yp</span><span class="w"></span></code> is responsible for the communication with the upper process:</p>
<a class="reference internal image-reference" href="../../_images/boundary_conditions2.pdf"><img alt="../../_images/boundary_conditions2.pdf" src="../../_images/boundary_conditions2.pdf" style="width: 800px;" /></a>
<p>Note that values only between <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="w"></span></code> and <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">i</span><span class="o">=</span><span class="n">itot</span><span class="mi">-1</span><span class="w"></span></code> (<code class="code highlight c-lang c docutils literal highlight-c"><span class="n">itot</span><span class="mi">-1</span><span class="w"></span></code> components) are communicated in each function, i.e., boundary values are not communicated, which is because their values are fixed and thus not necessary to be exchanged.
Also see <a class="reference internal" href="../parallel/halo.html#parallel-halo"><span class="std std-ref">src/parallel/halo.c</span></a>.</p>
</section>
</section>
<section id="fluid-update-boundaries-uy">
<h2>fluid_update_boundaries_uy<a class="headerlink" href="#fluid-update-boundaries-uy" title="Permalink to this heading">¶</a></h2>
<section id="id2">
<h3>Definition<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">fluid_update_boundaries_uy</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">param_t</span><span class="w"> </span><span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">parallel_t</span><span class="w"> </span><span class="o">*</span><span class="n">parallel</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">uy</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>intent</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>param</p></td>
<td><p>in</p></td>
<td><p>general parameters</p></td>
</tr>
<tr class="row-odd"><td><p>parallel</p></td>
<td><p>in</p></td>
<td><p>MPI parameters</p></td>
</tr>
<tr class="row-even"><td><p>uy</p></td>
<td><p>out</p></td>
<td><p>y direction velocity</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id3">
<h3>Description<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>Since the domain is wall-bounded in <span class="math notranslate nohighlight">\(x\)</span> direction, no-slip condition is imposed on the <cite>x</cite> boundaries:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">33</span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">jsize</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="linenos">34</span><span class="w">    </span><span class="n">UY</span><span class="p">(</span><span class="w">     </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="c1">// no-slip</span>
<span class="linenos">35</span><span class="w">    </span><span class="n">UY</span><span class="p">(</span><span class="n">itot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="c1">// no-slip</span>
<span class="linenos">36</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Note that <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">UY</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"></span></code> and <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">UY</span><span class="p">(</span><span class="n">itot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"></span></code> are defined at the wall locations although they are defined at cell center in the bulk region (see <a class="reference internal" href="../../numerical_method/spatial_discretisation/index.html#spatial-discretisation"><span class="std std-ref">Spatial discretisation</span></a>).</p>
<p>Also halo cells are communicated here:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">30</span><span class="w">  </span><span class="n">parallel_update_halo_ym</span><span class="p">(</span><span class="n">parallel</span><span class="p">,</span><span class="w"> </span><span class="n">itot</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jsize</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w">       </span><span class="mi">0</span><span class="p">));</span><span class="w"></span>
<span class="linenos">31</span><span class="w">  </span><span class="n">parallel_update_halo_yp</span><span class="p">(</span><span class="n">parallel</span><span class="p">,</span><span class="w"> </span><span class="n">itot</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w">     </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jsize</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<p>where <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">parallel_update_halo_ym</span><span class="w"></span></code> is responsible for the communication with the lower process:</p>
<a class="reference internal image-reference" href="../../_images/boundary_conditions3.pdf"><img alt="../../_images/boundary_conditions3.pdf" src="../../_images/boundary_conditions3.pdf" style="width: 800px;" /></a>
<p>while <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">parallel_update_halo_yp</span><span class="w"></span></code> is responsible for the communication with the upper process:</p>
<a class="reference internal image-reference" href="../../_images/boundary_conditions4.pdf"><img alt="../../_images/boundary_conditions4.pdf" src="../../_images/boundary_conditions4.pdf" style="width: 800px;" /></a>
<p>Note that values only between <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="w"></span></code> and <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">i</span><span class="o">=</span><span class="n">itot</span><span class="w"></span></code> (<code class="code highlight c-lang c docutils literal highlight-c"><span class="n">itot</span><span class="w"></span></code> components) are communicated in each function, i.e., boundary values are not communicated, which is because their values are fixed and thus not necessary to be exchanged.
Also see <a class="reference internal" href="../parallel/halo.html#parallel-halo"><span class="std std-ref">src/parallel/halo.c</span></a>.</p>
</section>
</section>
<section id="fluid-update-boundaries-p">
<h2>fluid_update_boundaries_p<a class="headerlink" href="#fluid-update-boundaries-p" title="Permalink to this heading">¶</a></h2>
<section id="id4">
<h3>Definition<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">fluid_update_boundaries_p</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">param_t</span><span class="w"> </span><span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">parallel_t</span><span class="w"> </span><span class="o">*</span><span class="n">parallel</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>intent</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>param</p></td>
<td><p>in</p></td>
<td><p>general parameters</p></td>
</tr>
<tr class="row-odd"><td><p>parallel</p></td>
<td><p>in</p></td>
<td><p>MPI parameters</p></td>
</tr>
<tr class="row-even"><td><p>p</p></td>
<td><p>out</p></td>
<td><p>pressure</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id5">
<h3>Description<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>Since the domain is wall-bounded in <span class="math notranslate nohighlight">\(x\)</span> direction, Neumann condition is imposed on the <cite>x</cite> boundaries:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">50</span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">jsize</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="linenos">51</span><span class="w">    </span><span class="n">P</span><span class="p">(</span><span class="w">     </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"> </span><span class="c1">// Neumann</span>
<span class="linenos">52</span><span class="w">    </span><span class="n">P</span><span class="p">(</span><span class="n">itot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">itot</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"> </span><span class="c1">// Neumann</span>
<span class="linenos">53</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Note that Neumann boundary condition is also used (implicitly assumed) in the Poisson solver (see <a class="reference internal" href="compute_potential.html#fluid-compute-potential"><span class="std std-ref">src/fluid/compute_potential.c</span></a>).</p>
<p>Also halo cells are communicated here:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">47</span><span class="w">  </span><span class="n">parallel_update_halo_ym</span><span class="p">(</span><span class="n">parallel</span><span class="p">,</span><span class="w"> </span><span class="n">itot</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jsize</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w">       </span><span class="mi">0</span><span class="p">));</span><span class="w"></span>
<span class="linenos">48</span><span class="w">  </span><span class="n">parallel_update_halo_yp</span><span class="p">(</span><span class="n">parallel</span><span class="p">,</span><span class="w"> </span><span class="n">itot</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w">     </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jsize</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<p>where <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">parallel_update_halo_ym</span><span class="w"></span></code> is responsible for the communication with the lower process:</p>
<a class="reference internal image-reference" href="../../_images/boundary_conditions5.pdf"><img alt="../../_images/boundary_conditions5.pdf" src="../../_images/boundary_conditions5.pdf" style="width: 800px;" /></a>
<p>while <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">parallel_update_halo_yp</span><span class="w"></span></code> is responsible for the communication with the upper process:</p>
<a class="reference internal image-reference" href="../../_images/boundary_conditions6.pdf"><img alt="../../_images/boundary_conditions6.pdf" src="../../_images/boundary_conditions6.pdf" style="width: 800px;" /></a>
<p>Note that values only between <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="w"></span></code> and <code class="code highlight c-lang c docutils literal highlight-c"><span class="n">i</span><span class="o">=</span><span class="n">itot</span><span class="w"></span></code> (<code class="code highlight c-lang c docutils literal highlight-c"><span class="n">itot</span><span class="w"></span></code> components) are communicated in each function, i.e., boundary values are not communicated, which is because their values are fixed and thus not necessary to be exchanged.
Since boundary values are functions of the inner point in this case, the boundary values should be updated after the communications.</p>
<p>Also see <a class="reference internal" href="../parallel/halo.html#parallel-halo"><span class="std std-ref">src/parallel/halo.c</span></a>.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Naoki Hori.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/implementation/fluid/boundary_conditions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>