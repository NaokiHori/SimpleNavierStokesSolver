
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Basic operators &#8212; Simple Navier-Stokes Solver 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"der": ["{\\frac{\\partial #1}{\\partial #2}}", 2], "dder": ["{\\frac{\\delta #1}{\\delta #2}}", 2], "mst": ["{\\gamma^{#1 #2}}", 2], "gx": ["{\\xi}"], "gy": ["{\\eta}"], "ux": ["{u_x}"], "uy": ["{u_y}"], "intrp": ["{\\overline{#1}^{#2}}", 2], "diffe": ["{\\delta_{#2} {#1}}", 2], "vat": ["{\\left. {#1} \\right|_{#2}}", 2], "ave": ["{\\left\\langle {#1} \\right\\rangle_{#2}}", 2], "pimm": ["i-1           "], "pim": ["i-\\frac{1}{2}"], "pic": ["i             "], "pip": ["i+\\frac{1}{2}"], "pipp": ["i+1           "], "pjmm": ["j-1           "], "pjm": ["j-\\frac{1}{2}"], "pjc": ["j             "], "pjp": ["j+\\frac{1}{2}"], "pjpp": ["j+1           "], "ximm": ["i-\\frac{1}{2}"], "xim": ["i             "], "xic": ["i+\\frac{1}{2}"], "xip": ["i+1           "], "xipp": ["i+\\frac{3}{2}"], "xjmm": ["j-1           "], "xjm": ["j-\\frac{1}{2}"], "xjc": ["j             "], "xjp": ["j+\\frac{1}{2}"], "xjpp": ["j+1           "], "yimm": ["i-1           "], "yim": ["i-\\frac{1}{2}"], "yic": ["i             "], "yip": ["i+\\frac{1}{2}"], "yipp": ["i+1           "], "yjmm": ["j-\\frac{1}{2}"], "yjm": ["j             "], "yjc": ["j+\\frac{1}{2}"], "yjp": ["j+1           "], "yjpp": ["j+\\frac{3}{2}"], "dintrpa": ["{\\overline{#1}^{#2}}", 2], "dintrpv": ["{\\widehat {#1}^{#2}}", 2], "dintrpu": ["{\\widetilde {#1}^{#2}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Mass balance and pressure equation" href="mass_balance_and_pressure_equation.html" />
    <link rel="prev" title="Discrete governing equations" href="index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Simple Navier-Stokes Solver</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NaokiHori&repo=SimpleNavierStokesSolver&type=true&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governing_equations/index.html">Governing equations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Numerical method</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../temporal_discretisation/index.html">Temporal discretisation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Spatial discretisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../implementation/index.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Numerical method</a><ul>
  <li><a href="../index.html">Spatial discretisation</a><ul>
  <li><a href="index.html">Discrete governing equations</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Discrete governing equations</a></li>
      <li>Next: <a href="mass_balance_and_pressure_equation.html" title="next chapter">Mass balance and pressure equation</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="basic-operators">
<span id="id1"></span><h1>Basic operators<a class="headerlink" href="#basic-operators" title="Permalink to this heading">¶</a></h1>
<p>Differentiations and interpolations are defined.</p>
<section id="conservative-form-and-differentiations">
<h2>Conservative form and differentiations<a class="headerlink" href="#conservative-form-and-differentiations" title="Permalink to this heading">¶</a></h2>
<p>First of all, we define the <em>conservative form</em> in both continuous and discrete domains.
In the continuous domain, we call terms <em>conservative</em> when written as</p>
<div class="math notranslate nohighlight">
\[\der{q}{x_i},\]</div>
<p>since the net increase and decrease of <span class="math notranslate nohighlight">\(q\)</span> (can be tensors of any order) is purely determined by the boundary values of <span class="math notranslate nohighlight">\(q\)</span>.</p>
<details>
<summary>
Derivation</summary><p>For simplicity, we consider one-dimensional space where the both edges are bounded or periodic.
When being written as</p>
<div class="math notranslate nohighlight">
\[\der{q}{x},\]</div>
<p>the volume integral of this term leads</p>
<div class="math notranslate nohighlight">
\[\int_{\text{left}}^{\text{right}} \der{q}{x} dx
=
\vat{q}{\text{right}} - \vat{q}{\text{left}}.\]</div>
<p>We notice that the total amount of <span class="math notranslate nohighlight">\(q\)</span> is <em>conserved</em> as long as <span class="math notranslate nohighlight">\(q\)</span> at the boundaries (flux) are null (<span class="math notranslate nohighlight">\(\vat{q}{\text{right}} = \vat{q}{\text{left}} \equiv 0\)</span>) or the periodic conditions are imposed, i.e. <span class="math notranslate nohighlight">\(\vat{q}{\text{right}} \equiv \vat{q}{\text{left}}\)</span>).</p>
</details><p>To mimic this relation in the discrete space, the discrete first-order derivatives should be given as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{\dder{q}{x}}{\pic}
=
\frac{\vat{q}{\pip} - \vat{q}{\pim}}{\vat{x}{\pip} - \vat{x}{\pim}}, \\\end{split}\]</div>
<p>at cell centers, while</p>
<div class="math notranslate nohighlight">
\[\vat{\dder{q}{x}}{\pip}
=
\frac{\vat{q}{\pipp} - \vat{q}{\pic}}{\vat{x}{\pipp} - \vat{x}{\pic}}.\]</div>
<p>at cell faces, respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hereafter <span class="math notranslate nohighlight">\(\der{q}{x}\)</span> (\partial) and <span class="math notranslate nohighlight">\(\dder{q}{x}\)</span> (\delta) are used to indicate derivatives in the continuous and discrete domains, respectively.</p>
</div>
<details>
<summary>
Derivation</summary><p>One-dimensional domain is considered in the derivations below for simplicity, whose extension to multi-dimensional domains is straightforward.</p>
<ol class="arabic">
<li><p>Derivatives at cell center, quantities at cell face</p>
<p>We consider quantity <span class="math notranslate nohighlight">\(q\)</span>, whose derivative is defined at each cell center, i.e.,</p>
<div class="math notranslate nohighlight">
\[\vat{\dder{q}{x}}{\pic}.\]</div>
<p>The integral of this derivative in the whole domain leads</p>
<div class="math notranslate nohighlight">
\[\int \der{q}{x} dx
\approx
\sum_{i} \vat{
   \left(
      \dder{q}{x} \Delta x
   \right)
}{\pic}.\]</div>
<p>Since <span class="math notranslate nohighlight">\(\vat{\Delta x}{\pic}\)</span> denotes the size of the cell at each cell center, it is clear that we have</p>
<div class="math notranslate nohighlight">
\[\vat{\Delta x}{\pic} = \vat{x}{\pip} - \vat{x}{\pim}.\]</div>
<p>Now we would like to <em>mimic</em> the relation in the continuous domain, i.e., this volume integral should be merely determined by the boundary values.
To satisfy this requirement, the denominator of the gradient <span class="math notranslate nohighlight">\(\delta x\)</span> at each cell center should be cancelled out by the size of the cell <span class="math notranslate nohighlight">\(\vat{\Delta x}{\pic}\)</span>, giving</p>
<div class="math notranslate nohighlight">
\[\vat{\delta x}{\pic} = \vat{x}{\pip} - \vat{x}{\pim}.\]</div>
<p>Also, it is natural to use the same scheme for the numerator <span class="math notranslate nohighlight">\(\delta q\)</span> since they have the same form, i.e.,</p>
<div class="math notranslate nohighlight">
\[\vat{\delta q}{\pic} = \vat{q}{\pip} - \vat{q}{\pim}.\]</div>
<p>Thus, we can conclude that the derivative at cell center should be given as</p>
<div class="math notranslate nohighlight">
\[\vat{\dder{q}{x}}{\pic}
=
\frac{\vat{q}{\pip} - \vat{q}{\pim}}{\vat{x}{\pip} - \vat{x}{\pim}},\]</div>
<p>so that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int \der{q}{x} dx
&amp; \approx
\sum \frac{\vat{q}{\pip} - \vat{q}{\pim}}{\vat{x}{\pip} - \vat{x}{\pim}} \left( \vat{x}{\pip} - \vat{x}{\pim} \right) \\
&amp; =
\sum \vat{q}{\pip} - \vat{q}{\pim} \\
&amp; =
\vat{q}{\text{(right cell face)}} - \vat{q}{\text{(left cell face)}}.\end{split}\]</div>
<p>This is totally analogous to the continuous counterpart shown above.</p>
</li>
<li><p>Derivatives at cell face, quantities at cell center</p>
<p>We can derive a consistent discretisation of the derivative at cell face as</p>
<div class="math notranslate nohighlight">
\[\vat{\dder{q}{x}}{\xic}
=
\frac{\vat{q}{\xip} - \vat{q}{\xim}}{\vat{x}{\xip} - \vat{x}{\xim}}.\]</div>
<p>Special care should be taken for the boudnary treatment since <span class="math notranslate nohighlight">\(q\)</span> is defined at cell center and boundary values (cell faces) are missing.
One convenient way is to define boundary values explicitly; in addition to the cell center values, additional grid points are introduced exactly on the boundaries.
This method is adopted in this project for values defined at cell center (see <a class="reference internal" href="../domain.html#domain"><span class="std std-ref">the domain setup</span></a>).</p>
<p>Another way is to define <em>ghost cells</em> outside the domain.
They are the fictitious grids to impose proper boundary conditions, whose values are extrapolated from the bulk.</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sometimes the above discrete derivative is represented as</p>
<div class="math notranslate nohighlight">
\[\frac{\vat{q}{\pipp} - \vat{q}{\pimm}}{\vat{x}{\pipp} - \vat{x}{\pimm}}.\]</div>
<p>With this formulation, the approximation of the volume integral should be modified correspondingly, i.e.</p>
<div class="math notranslate nohighlight">
\[\int q dx
\approx
\sum q \left( \vat{x}{\pipp} - \vat{x}{\pimm} \right).\]</div>
<p>One can see that this cannot be conservative in general, since some <span class="math notranslate nohighlight">\(q\)</span> values inside bulk cannot be eliminated.
Thus, in the following discussion, we try to avoid this formulation.</p>
</div>
</details></section>
<section id="discrete-volume-integrals">
<h2>Discrete volume integrals<a class="headerlink" href="#discrete-volume-integrals" title="Permalink to this heading">¶</a></h2>
<p>In this part we define the approximation of the volume integral</p>
<div class="math notranslate nohighlight">
\[\int q dx dy.\]</div>
<p>Because of the staggered grid arrangement, we need the following three different definitions.</p>
<ol class="arabic">
<li><p>Volume integral at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span></p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j} \vat{
   \left(
      q
      \Delta x
      \Delta y
   \right)
}{\xic, \xjc},\]</div>
<p>which is used to integrate a quantity defined at <span class="math notranslate nohighlight">\(x\)</span> cell face.</p>
</li>
<li><p>Volume integral at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span></p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j} \vat{
   \left(
      q
      \Delta x
      \Delta y
   \right)
}{\yic, \yjc},\]</div>
<p>which is used to integrate a quantity defined at <span class="math notranslate nohighlight">\(y\)</span> cell face.</p>
</li>
<li><p>Volume integral at <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span></p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j} \vat{
   \left(
      q
      \Delta x
      \Delta y
   \right)
}{\pic, \pjc},\]</div>
<p>which is used to integrate a quantity defined at cell center.</p>
</li>
</ol>
</section>
<section id="interpolations">
<h2>Interpolations<a class="headerlink" href="#interpolations" title="Permalink to this heading">¶</a></h2>
<p>Because of <a class="reference internal" href="../domain.html#domain"><span class="std std-ref">the staggered grid arrangement</span></a>, most variables are not defined at the locations we want, when interpolations defined here are necessary.</p>
<p>Three different symbols are used in this project, whose superscripts indicate the direction to which being interpolated.</p>
<ol class="arabic">
<li><p>Arithmetic averages <span class="math notranslate nohighlight">\(\dintrpa{q}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpa{q}{y}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
   x \, \text{direction}
   &amp;
   \begin{cases}
      \text{center-to-face}
      &amp;
      2 \vat{\dintrpv{q}{x}}{\xic}
      \equiv
      \vat{q}{\xim}
      +
      \vat{q}{\xip}, \\
      \text{face-to-center}
      &amp;
      2 \vat{\dintrpv{q}{x}}{\pic}
      \equiv
      \vat{q}{\pim}
      +
      \vat{q}{\pip}
   \end{cases} \\
   y \, \text{direction}
   &amp;
   \begin{cases}
      \text{center-to-face}
      &amp;
      2 \vat{\dintrpv{q}{y}}{\yjc}
      \equiv
      \vat{q}{\yjm}
      +
      \vat{q}{\yjp}, \\
      \text{face-to-center}
      &amp;
      2 \vat{\dintrpv{q}{y}}{\pjc}
      \equiv
      \vat{q}{\pjm}
      +
      \vat{q}{\pjp}
   \end{cases}
\end{cases}\end{split}\]</div>
</li>
<li><p>Averages weighted by the cell sizes <span class="math notranslate nohighlight">\(\dintrpv{q}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpv{q}{y}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
   x \, \text{direction}
   &amp;
   \begin{cases}
      \text{center-to-face}
      &amp;
      2 \Delta x_{\xic} \vat{\dintrpv{q}{x}}{\xic}
      \equiv
      \Delta x_{\xim} \vat{q}{\xim}
      +
      \Delta x_{\xip} \vat{q}{\xip}, \\
      \text{face-to-center}
      &amp;
      2 \Delta x_{\pic} \vat{\dintrpv{q}{x}}{\pic}
      \equiv
      \Delta x_{\pim} \vat{q}{\pim}
      +
      \Delta x_{\pip} \vat{q}{\pip}
   \end{cases} \\
   y \, \text{direction}
   &amp;
   \begin{cases}
      \text{center-to-face}
      &amp;
      2 \Delta y \vat{\dintrpv{q}{y}}{\yjc}
      \equiv
      \Delta y \vat{q}{\yjm}
      +
      \Delta y \vat{q}{\yjp}, \\
      \text{face-to-center}
      &amp;
      2 \Delta y \vat{\dintrpv{q}{y}}{\pjc}
      \equiv
      \Delta y \vat{q}{\pjm}
      +
      \Delta y \vat{q}{\pjp}
   \end{cases}
\end{cases}\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\dintrpv{q}{y}\)</span> is identical to <span class="math notranslate nohighlight">\(\dintrpa{q}{y}\)</span> since only uniform grid spacings are allowed in <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
</li>
<li><p>Placeholders <span class="math notranslate nohighlight">\(\dintrpu{q}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpu{q}{y}\)</span></p>
<p>They do not have explicit formulations, i.e, we do not know anything except it is interpolated in the specified direction.
They are used as placeholders, which must be replaced by the other interpolation symbol defined above to conclude.</p>
</li>
</ol>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Naoki Hori.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/numerical_method/spatial_discretisation/discrete_governing_equations/basic_operators.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>