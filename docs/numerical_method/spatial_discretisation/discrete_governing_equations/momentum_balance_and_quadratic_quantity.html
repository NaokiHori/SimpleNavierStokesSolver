
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Momentum balance and quadratic quantity &#8212; Simple Navier-Stokes Solver 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"der": ["{\\frac{\\partial #1}{\\partial #2}}", 2], "dder": ["{\\frac{\\delta #1}{\\delta #2}}", 2], "mst": ["{\\gamma^{#1 #2}}", 2], "gx": ["{\\xi}"], "gy": ["{\\eta}"], "ux": ["{u_x}"], "uy": ["{u_y}"], "intrp": ["{\\overline{#1}^{#2}}", 2], "diffe": ["{\\delta_{#2} {#1}}", 2], "vat": ["{\\left. {#1} \\right|_{#2}}", 2], "ave": ["{\\left\\langle {#1} \\right\\rangle_{#2}}", 2], "pimm": ["i-1           "], "pim": ["i-\\frac{1}{2}"], "pic": ["i             "], "pip": ["i+\\frac{1}{2}"], "pipp": ["i+1           "], "pjmm": ["j-1           "], "pjm": ["j-\\frac{1}{2}"], "pjc": ["j             "], "pjp": ["j+\\frac{1}{2}"], "pjpp": ["j+1           "], "ximm": ["i-\\frac{1}{2}"], "xim": ["i             "], "xic": ["i+\\frac{1}{2}"], "xip": ["i+1           "], "xipp": ["i+\\frac{3}{2}"], "xjmm": ["j-1           "], "xjm": ["j-\\frac{1}{2}"], "xjc": ["j             "], "xjp": ["j+\\frac{1}{2}"], "xjpp": ["j+1           "], "yimm": ["i-1           "], "yim": ["i-\\frac{1}{2}"], "yic": ["i             "], "yip": ["i+\\frac{1}{2}"], "yipp": ["i+1           "], "yjmm": ["j-\\frac{1}{2}"], "yjm": ["j             "], "yjc": ["j+\\frac{1}{2}"], "yjp": ["j+1           "], "yjpp": ["j+\\frac{3}{2}"], "dintrpa": ["{\\overline{#1}^{#2}}", 2], "dintrpv": ["{\\widehat {#1}^{#2}}", 2], "dintrpu": ["{\\widetilde {#1}^{#2}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Thermal energy balance and quadratic quantity" href="thermal_energy_balance_and_quadratic_quantity.html" />
    <link rel="prev" title="Mass balance and pressure equation" href="mass_balance_and_pressure_equation.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Simple Navier-Stokes Solver</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NaokiHori&repo=SimpleNavierStokesSolver&type=true&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governing_equations/index.html">Governing equations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Numerical method</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../temporal_discretisation/index.html">Temporal discretisation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Spatial discretisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../implementation/index.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Numerical method</a><ul>
  <li><a href="../index.html">Spatial discretisation</a><ul>
  <li><a href="index.html">Discrete governing equations</a><ul>
      <li>Previous: <a href="mass_balance_and_pressure_equation.html" title="previous chapter">Mass balance and pressure equation</a></li>
      <li>Next: <a href="thermal_energy_balance_and_quadratic_quantity.html" title="next chapter">Thermal energy balance and quadratic quantity</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="momentum-balance-and-quadratic-quantity">
<span id="momentum-balance"></span><h1>Momentum balance and quadratic quantity<a class="headerlink" href="#momentum-balance-and-quadratic-quantity" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>In this part, we consider to discretise</p>
<div class="math notranslate nohighlight">
\[\der{\ux}{t}
+
u_j \der{\ux}{x_j}
=
-\der{p}{x}
+
\frac{\sqrt{Pr}}{\sqrt{Ra}} \frac{\partial^2 \ux}{\partial x_j \partial x_j}
+
T\]</div>
<p>at <span class="math notranslate nohighlight">\(x\)</span> cell faces <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>, and</p>
<div class="math notranslate nohighlight">
\[\der{\uy}{t}
+
u_j \der{\uy}{x_j}
=
-\der{p}{y}
+
\frac{\sqrt{Pr}}{\sqrt{Ra}} \frac{\partial^2 \uy}{\partial x_j \partial x_j}\]</div>
<p>at <span class="math notranslate nohighlight">\(y\)</span> cell faces <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>.</p>
<p>Also a relevant (dependent) kinetic energy balance</p>
<div class="math notranslate nohighlight">
\[\der{k}{t}
+
u_i \der{k}{x_i}
=
-u_i \der{p}{x_i}
+ \frac{\sqrt{Pr}}{\sqrt{Ra}} \der{}{x_j} \left( u_i \der{u_i}{x_j} \right)
- \frac{\sqrt{Pr}}{\sqrt{Ra}} \der{u_i}{x_j} \der{u_i}{x_j}
+ u_i T \delta_{ix}\]</div>
<p>is considered.
Note that this can be obtained by taking the inner product of the velocity <span class="math notranslate nohighlight">\(u_i\)</span> and the momentum balance, whose derivation in the continuous domain can be found in <a class="reference internal" href="../../../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a>.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h2>
<p>The following discrete equations are directly implemented in the code.</p>
<p>Momentum balance in <span class="math notranslate nohighlight">\(x\)</span> direction at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\der{\ux}{t}
+
\dintrpv{
   \dintrpa{\ux}{x}
   \dder{\ux}{x}
}{x}
+
\dintrpa{
   \dintrpv{\uy}{x}
   \dder{\ux}{y}
}{y}
=
-\dder{p}{x}
+
\frac{\sqrt{Pr}}{\sqrt{Ra}} \left\{
   \dder{}{x} \left( \dder{\ux}{x} \right)
   +
   \dder{}{y} \left( \dder{\ux}{y} \right)
\right\}
+
\dintrpu{T}{x}.\]</div>
<p>Momentum balance in <span class="math notranslate nohighlight">\(y\)</span> direction at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\der{\uy}{t}
+
\dintrpv{
   \dintrpa{\ux}{y}
   \dder{\uy}{x}
}{x}
+
\dintrpa{
   \dintrpa{\uy}{y}
   \dder{\uy}{y}
}{y}
=
-\dder{p}{y}
+
\frac{\sqrt{Pr}}{\sqrt{Ra}} \left\{
   \dder{}{x} \left( \dder{\uy}{x} \right)
   +
   \dder{}{y} \left( \dder{\uy}{y} \right)
\right\}.\]</div>
<p>Their implementations can be found in <a class="reference internal" href="../../../implementation/fluid/update_velocity.html#fluid-update-velocity"><span class="std std-ref">src/fluid/update_velocity.c</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic">
<li><p>Discrete thermal forcing term</p>
<p>We cannot define the forcing term in <span class="math notranslate nohighlight">\(x\)</span> direction <span class="math notranslate nohighlight">\(\dintrpu{T}{x}\)</span> here (recall that <em>widehat</em> symbol is a placeholder).
In order to decide the correct interpolation, we need to consider the equation of the internal energy and Nusselt number relations.</p>
</li>
<li><p>Discrete kinetic energy</p>
<p>In the continuous space, local kinetic energy <span class="math notranslate nohighlight">\(k = k \left( t, x, y \right)\)</span> is clearly given as the sum of <span class="math notranslate nohighlight">\(\frac{1}{2} \ux^2 \left( t, x, y \right)\)</span> and <span class="math notranslate nohighlight">\(\frac{1}{2} \uy^2 \left( t, x, y \right)\)</span>.
After being discretised, however, the <em>definition</em> of kinetic energy itself is ambiguous since <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span> are defined at different locations.</p>
<p>In this project, we consider these two contributions separately:</p>
<div class="math notranslate nohighlight">
\[\der{}{t} \vat{
   \left( \frac{1}{2} \ux^2 \right)
}{\xic, \xjc} + \cdots,\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\der{}{t} \vat{
   \left( \frac{1}{2} \uy^2 \right)
}{\yic, \yjc} + \cdots,\]</div>
<p>which can be obtained by multiplying the momentum balances by <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span>, respectively.</p>
<p>We regard the total discrete kinetic energy <span class="math notranslate nohighlight">\(K = K \left( t \right)\)</span> as the sum of the volume integrals of these two equations:</p>
<div class="math notranslate nohighlight">
\[\der{K}{t}
=
\sum_{i} \sum_{j} \der{}{t} \vat{
   \left(
      \frac{1}{2} \ux^2
      \Delta x \Delta y
   \right)
}{\xic, \xjc}
+
\sum_{i} \sum_{j} \der{}{t} \vat{
   \left(
      \frac{1}{2} \uy^2
      \Delta x \Delta y
   \right)
}{\yic, \yjc},\]</div>
<p>which will be investigated in this section.</p>
</li>
</ol>
</div>
</section>
<section id="derivations-local-conservations">
<h2>Derivations - local conservations<a class="headerlink" href="#derivations-local-conservations" title="Permalink to this heading">¶</a></h2>
<p>In this part, we focus on the <em>local</em> property of equations, e.g., how each term is discretised to make it <a class="reference internal" href="basic_operators.html#basic-operators"><span class="std std-ref">conservative</span></a>.
This is necessary to discuss the <em>global</em> properties (after being integrated in the volume), which will be discussed later.</p>
<section id="advective-terms">
<h3>Advective terms<a class="headerlink" href="#advective-terms" title="Permalink to this heading">¶</a></h3>
<p>Mathematically speaking (in the continuous domain), advective terms should not alter the total amount of the transported quantity.
Here, they should be designed so that not only the net momentum but the total kinetic energy (quadratic quantity) are conserved.</p>
<section id="divergence-form-of-advective-terms">
<h4>1. Divergence form of advective terms<a class="headerlink" href="#divergence-form-of-advective-terms" title="Permalink to this heading">¶</a></h4>
<p>We find the discrete form of the advection of <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span> are given as</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{x}
   \dintrpa{\ux}{x}
}{x}
+
\dder{
   \dintrpu{\uy}{x}
   \dintrpa{\ux}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{y}
   \dintrpu{\uy}{x}
}{x}
+
\dder{
   \dintrpa{\uy}{y}
   \dintrpa{\uy}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>, respectively.
Note that interpolations <span class="math notranslate nohighlight">\(\dintrpu{\uy}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpu{\ux}{y}\)</span> are undefined.</p>
<details>
<summary>
Derivations</summary><p>We first focus on the advective terms in the momentum balance</p>
<div class="math notranslate nohighlight">
\[u_j \der{u_i}{x_j},\]</div>
<p>which is called as the <em>gradient form</em>.
Obviously this is not in <a class="reference internal" href="mass_balance_and_pressure_equation.html#mass-balance-and-pressure-equation"><span class="std std-ref">a conservative form</span></a> since this is not written as <span class="math notranslate nohighlight">\(\partial / \partial x_i\)</span>.
In order to visually understand that this term really conserves momentum, we use</p>
<div class="math notranslate nohighlight">
\[u_j \der{u_i}{x_j}
+
u_i \der{u_j}{x_j}
=
\der{u_j u_i}{x_j}.\]</div>
<p>Note that the second term in the left-hand-side is the incompressibility constraint weighted by <span class="math notranslate nohighlight">\(u_i\)</span>.
Thus, when the incompressibility constraint is satisfied, the advective term can be written in a conservative form, which is named as the <em>divergence form</em>.</p>
<p>Since they are inherently momentum-conservative, we discretise this form instead of the gradient form, giving</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpu{\ux}{x}
   \dintrpu{\ux}{x}
}{x}
+
\dder{
   \dintrpu{\uy}{x}
   \dintrpu{\ux}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpu{\ux}{y}
   \dintrpu{\uy}{x}
}{x}
+
\dder{
   \dintrpu{\uy}{y}
   \dintrpu{\uy}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>.
It is readily apparent that they are discretely-conservative.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are two possibilities to write <span class="math notranslate nohighlight">\(\ux \ux\)</span>.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\dintrpu{\left( \ux \right)^2}{x}\)</span>, interpolated after squared.</p></li>
<li><p><span class="math notranslate nohighlight">\(\left( \dintrpu{\ux}{x} \right)^2 = \dintrpu{\ux}{x} \dintrpu{\ux}{x}\)</span>, squared after interpolated.</p></li>
</ol>
<p>We take the second option since it is consistent with the other direction <span class="math notranslate nohighlight">\(\dintrpu{\uy}{x} \dintrpu{\ux}{y}\)</span>.</p>
</div>
<p>Placeholders <span class="math notranslate nohighlight">\(\dintrpu{q}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpu{q}{y}\)</span> can be partially replaced by arithmetic averages <span class="math notranslate nohighlight">\(\dintrpa{q}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpa{q}{y}\)</span> since cell center locates in the middle of the surrounding two cell faces in this project (see <a class="reference internal" href="../domain.html#domain"><span class="std std-ref">the domain setup</span></a>).
This partially reveals the advective terms</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{x}
   \dintrpa{\ux}{x}
}{x}
+
\dder{
   \dintrpu{\uy}{x}
   \dintrpa{\ux}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{y}
   \dintrpu{\uy}{x}
}{x}
+
\dder{
   \dintrpa{\uy}{y}
   \dintrpa{\uy}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>.</p>
<p>As can be seen, two unknown interpolations are remained, which will be resolved by investigating the conservation property of the discrete kinetic energy (quadratic quantities) in the next section.</p>
</details></section>
<section id="advection-of-quadratic-quantities">
<h4>2. Advection of quadratic quantities<a class="headerlink" href="#advection-of-quadratic-quantities" title="Permalink to this heading">¶</a></h4>
<p>We find the discrete form of the advection of <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span> are given as</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{x}
   \dintrpa{\ux}{x}
}{x}
+
\dder{
   \dintrpv{\uy}{x}
   \dintrpa{\ux}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{y}
   \dintrpa{\uy}{x}
}{x}
+
\dder{
   \dintrpa{\uy}{y}
   \dintrpa{\uy}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>, respectively.
Note that interpolations <span class="math notranslate nohighlight">\(\dintrpv{\uy}{x}\)</span> and <span class="math notranslate nohighlight">\(\dintrpa{\ux}{y}\)</span>, which were undefined, are concluded.</p>
<details>
<summary>
Derivations</summary><p>In the continuous domain, the advection of kinetic energy is obtained by taking the inner product of the velocity and the momentum advection.
Here we consider the counterpart in the discrete domain.</p>
<p>In <span class="math notranslate nohighlight">\(x\)</span> direction, at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> where <span class="math notranslate nohighlight">\(\ux\)</span> is defined, we have</p>
<div class="math notranslate nohighlight">
\[\ux \left(
   \dder{
      \dintrpa{\ux}{x}
      \dintrpa{\ux}{x}
   }{x}
   +
   \dder{
      \dintrpu{\uy}{x}
      \dintrpa{\ux}{y}
   }{y}
\right).\]</div>
<p>The first term leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp; \vat{\ux}{\xic, \xjc}
\frac{
   \vat{
      \dintrpa{\ux}{x}
   }{\xip, \xjc}
   \frac{
      \vat{\ux}{\xipp, \xjc}
      +
      \vat{\ux}{\xic , \xjc}
   }{2}
   -
   \vat{
      \dintrpa{\ux}{x}
   }{\xim, \xjc}
   \frac{
      \vat{\ux}{\xic , \xjc}
      +
      \vat{\ux}{\ximm, \xjc}
   }{2}
}{\Delta x_{\xic}} \\
&amp; =
\frac{
   \vat{
      \dintrpa{\ux}{x}
   }{\xip, \xjc}
   \frac{
      \vat{\ux}{\xipp, \xjc}
      \vat{\ux}{\xic,  \xjc}
   }{2}
   -
   \vat{
      \dintrpa{\ux}{x}
   }{\xim, \xjc}
   \frac{
      \vat{\ux}{\xic,  \xjc}
      \vat{\ux}{\ximm, \xjc}
   }{2}
}{\Delta x_{\xic}}
+
\frac{
   \vat{\ux^2}{\xic, \xjc}
}{2}
\frac{
   \vat{
      \dintrpa{\ux}{x}
   }{\xip, \xjc}
   -
   \vat{
      \dintrpa{\ux}{x}
   }{\xim, \xjc}
}{\Delta x_{\xic}} \\
&amp; = \dder{
   \dintrpa{\ux}{x}
   q_{xx}
}{x}
+
\frac{
   \vat{\ux^2}{\xic, \xjc}
}{2}
\frac{
   \vat{
      \dintrpa{\ux}{x}
   }{\xip, \xjc}
   -
   \vat{
      \dintrpa{\ux}{x}
   }{\xim, \xjc}
}{\Delta x_{\xic}},\end{split}\]</div>
<p>while the second term leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp; \vat{\ux}{\xic, \xjc}
\frac{
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjp}
   \frac{
      \vat{\ux}{\xic, \xjpp}
      +
      \vat{\ux}{\xic, \xjc }
   }{2}
   -
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjm}
   \frac{
      \vat{\ux}{\xic, \xjc }
      +
      \vat{\ux}{\xic, \xjmm}
   }{2}
}{\Delta y} \\
&amp; =
\frac{
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjp}
   \frac{
      \vat{\uy}{\xic, \xjpp}
      \vat{\uy}{\xic, \xjc }
   }{2}
   -
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjm}
   \frac{
      \vat{\uy}{\xic, \xjc }
      \vat{\uy}{\xic, \xjmm}
   }{2}
}{\Delta y}
+
\frac{
   \vat{\ux^2}{\xic, \xjc}
}{2}
\frac{
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjp}
   -
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjm}
}{\Delta y} \\
&amp; =
\dder{
   \dintrpu{\uy}{x}
   q_{xy}
}{y}
+
\frac{
   \vat{\ux^2}{\xic, \xjc}
}{2}
\frac{
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjp}
   -
   \vat{
      \dintrpu{\uy}{x}
   }{\xic, \xjm}
}{\Delta y},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(q_{xx}\)</span> and <span class="math notranslate nohighlight">\(q_{xy}\)</span> are quadratic quantities defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{q_{xx}}{\xip, \xjc}
&amp; \equiv
\frac{1}{2}
\vat{\ux}{\xipp, \xjc}
\vat{\ux}{\xic,  \xjc}, \\
\vat{q_{xy}}{\xic, \xjp}
&amp; \equiv
\frac{1}{2}
\vat{\ux}{\xic, \xjpp}
\vat{\ux}{\xic, \xjc }.\end{split}\]</div>
<p>We request the volume integral of the summation of these two terms is conserved.
The first terms are in conservative forms and thus they satisfy the requirement.
The residual leads</p>
<div class="math notranslate nohighlight">
\[\frac{
   \vat{\ux^2}{\xic, \xjc}
}{2}
\left(
   \frac{
      \vat{
         \dintrpa{\ux}{x}
      }{\xip, \xjc}
      -
      \vat{
         \dintrpa{\ux}{x}
      }{\xim, \xjc}
   }{\Delta x_{\xic}}
   +
   \frac{
      \vat{
         \dintrpu{\uy}{x}
      }{\xic, \xjp}
      -
      \vat{
         \dintrpu{\uy}{x}
      }{\xic, \xjm}
   }{\Delta y}
\right),\]</div>
<p>which should vanish.</p>
<p>The first term inside parenthesis can be written as</p>
<div class="math notranslate nohighlight">
\[\frac{\Delta x_{\xip}}{2 \Delta x_{\xic}} \vat{\dder{\ux}{x}}{\xip, \xjc}
+
\frac{\Delta x_{\xim}}{2 \Delta x_{\xic}} \vat{\dder{\ux}{x}}{\xim, \xjc}.\]</div>
<p>Although the explicit forms of <span class="math notranslate nohighlight">\(\vat{\dintrpu{\uy}{x}}{\xic, \xjp}\)</span> and <span class="math notranslate nohighlight">\(\vat{\dintrpu{\uy}{x}}{\xic, \xjm}\)</span> are unknown, they should be written as linear combinations:</p>
<div class="math notranslate nohighlight">
\[\vat{\dintrpu{\uy}{x}}{\xic, \cdots}
=
\vat{C}{\xip} \vat{\uy}{\xip, \cdots}
+
\vat{C}{\xim} \vat{\uy}{\xim, \cdots}.\]</div>
<p>By using this relation, the second term inside parenthesis can be written as</p>
<div class="math notranslate nohighlight">
\[\vat{C}{\xip} \vat{\dder{\uy}{y}}{\xip, \xjc}
+
\vat{C}{\xim} \vat{\dder{\uy}{y}}{\xim, \xjc}.\]</div>
<p>Thus, we notice</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{C}{\xip}
&amp; =
\frac{\Delta x_{\xip}}{2 \Delta x_{\xic}}, \\
\vat{C}{\xim}
&amp; =
\frac{\Delta x_{\xim}}{2 \Delta x_{\xic}},\end{split}\]</div>
<p>with which the term inside the parenthesis vanishes thanks to the incompressibility constraint.</p>
<p>Similarly, in <span class="math notranslate nohighlight">\(y\)</span> direction at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span> where <span class="math notranslate nohighlight">\(\uy\)</span> is defined, we have</p>
<div class="math notranslate nohighlight">
\[\uy \left(
   \dder{
      \dintrpa{\ux}{y}
      \dintrpu{\uy}{x}
   }{x}
   +
   \dder{
      \dintrpa{\uy}{y}
      \dintrpa{\uy}{y}
   }{y}
\right).\]</div>
<p>The second term is simply</p>
<div class="math notranslate nohighlight">
\[\dder{\dintrpa{\uy}{y} q_{yy}}{y}
+
\frac{
   \vat{\uy^2}{\yic, \yjc}
}{2}
\frac{1}{2} \left(
   \vat{\dder{\uy}{y}}{\yic, \yjp}
   -
   \vat{\dder{\uy}{y}}{\yic, \yjm}
\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(q_{yy}\)</span> is the quadratic quantity defined as</p>
<div class="math notranslate nohighlight">
\[\vat{q_{yy}}{\yic, \yjp}
\equiv
\frac{1}{2}
\vat{\uy}{\yic, \yjpp}
\vat{\uy}{\yic, \yjc }.\]</div>
<p>Regarding the first term, we let the coefficients of unknown interpolations as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{
   \dintrpu{\uy}{x}
}{\yim, \yjc}
&amp; \equiv
\vat{c^-}{\yimm} \vat{\uy}{\yimm}
+
\vat{c^-}{\yic } \vat{\uy}{\yic }, \\
\vat{
   \dintrpu{\uy}{x}
}{\yip, \yjc}
&amp; \equiv
\vat{c^+}{\yic } \vat{\uy}{\yic }
+
\vat{c^+}{\yipp} \vat{\uy}{\yipp},\end{split}\]</div>
<p>giving</p>
<div class="math notranslate nohighlight">
\[\color{blue}{\vat{\uy}{\yic, \yjc}}
\frac{
   \vat{
      \dintrpa{\ux}{y}
   }{\yip, \yjc}
   \left(
      \color{blue}{
      \vat{c^+}{\yipp} \vat{\uy}{\yipp, \yjc}
      }
      +
      \vat{c^+}{\yic } \vat{\uy}{\yic , \yjc}
   \right)
   -
   \vat{
      \dintrpa{\ux}{y}
   }{\yim, \yjc}
   \left(
      \vat{c^-}{\yic } \vat{\uy}{\yic , \yjc}
      +
      \color{blue}{
      \vat{c^-}{\yimm} \vat{\uy}{\yimm, \yjc}
      }
   \right)
}{\Delta x_{\yic}}.\]</div>
<p>We notice two constraints to determine coefficients.</p>
<ol class="arabic">
<li><p>Quadratic quantity</p>
<p>We use terms coloured in blue to define quadratic quantity, which request the coefficients <span class="math notranslate nohighlight">\(\vat{c^+}{\yipp}\)</span> and <span class="math notranslate nohighlight">\(\vat{c^-}{\yimm}\)</span> to be <span class="math notranslate nohighlight">\(1/2\)</span>, so that</p>
<div class="math notranslate nohighlight">
\[\vat{q_{yx}}{\yip, \yjc}
\equiv
\frac{1}{2}
\vat{\uy}{\yipp, \yjc}
\vat{\uy}{\yic,  \yjc}\]</div>
<p>can be defined and we are able to write the bluish terms in a conservative form</p>
<div class="math notranslate nohighlight">
\[\dder{
   \dintrpa{\ux}{y}
   q_{yx}
}{x}.\]</div>
</li>
<li><p>Residual</p>
<p>The remained term yields</p>
<div class="math notranslate nohighlight">
\[\vat{\uy^2}{\yic, \yjc}
\frac{
   \vat{c^+}{\yic}
   \vat{
      \dintrpa{\ux}{y}
   }{\yip, \yjc}
   -
   \vat{c^-}{\yic}
   \vat{
      \dintrpa{\ux}{y}
   }{\yim, \yjc}
}{\Delta x_{\yic}}.\]</div>
<p>In order to make them canceled out with the other residual, we notice the coefficients must be <span class="math notranslate nohighlight">\(1/2\)</span> again.</p>
</li>
</ol>
<p>Thus, we notice that arithmetic averages <span class="math notranslate nohighlight">\(\dintrpa{q}{x}\)</span> should be used for the unknown interpolations existing in the <span class="math notranslate nohighlight">\(y\)</span> momentum advection.</p>
<p>Finally, we can conclude the explicit forms of the advective terms in divergence form as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\der{
   \ux
   \ux
}{x}
+
\der{
   \uy
   \ux
}{y}
&amp; =
\color{red}{
   \dder{
      \dintrpa{\ux}{x}
      \dintrpa{\ux}{x}
   }{x}
   +
   \dder{
      \dintrpv{\uy}{x}
      \dintrpa{\ux}{y}
   }{y}
}, \\
\der{
   \ux
   \uy
}{x}
+
\der{
   \uy
   \uy
}{y}
&amp; =
\color{red}{
   \dder{
      \dintrpa{\ux}{y}
      \dintrpa{\uy}{x}
   }{x}
   +
   \dder{
      \dintrpa{\uy}{y}
      \dintrpa{\uy}{y}
   }{y}
}.\end{split}\]</div>
</details></section>
<section id="gradient-form-of-advective-terms">
<h4>3. Gradient form of advective terms<a class="headerlink" href="#gradient-form-of-advective-terms" title="Permalink to this heading">¶</a></h4>
<p>Finally we find that the advective terms can be written as</p>
<div class="math notranslate nohighlight">
\[\dintrpv{
   \dintrpa{\ux}{x}
   \dder{\ux}{x}
}{x}
+
\dintrpa{
   \dintrpv{\uy}{x}
   \dder{\ux}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\dintrpv{
   \dintrpa{\ux}{y}
   \dder{\uy}{x}
}{x}
+
\dintrpa{
   \dintrpa{\uy}{y}
   \dder{\uy}{y}
}{y}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span> in each direction.</p>
<details>
<summary>
Derivations</summary><ol class="arabic">
<li><p>Advection of <span class="math notranslate nohighlight">\(\ux\)</span></p>
<p>The gradient form</p>
<div class="math notranslate nohighlight">
\[\ux \dder{\ux}{x}
+
\uy \dder{\ux}{y}\]</div>
<p>is defined at <span class="math notranslate nohighlight">\(x\)</span> cell face <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and  is written as</p>
<div class="math notranslate nohighlight">
\[\dder{\ux \ux}{x}
+
\dder{\uy \ux}{y}
-
\ux \left(
   \dder{\ux}{x}
   +
   \dder{\uy}{y}
\right)\]</div>
<p>i.e.,</p>
<div class="math notranslate nohighlight">
\[\left( \text{divergence form} \right) - \ux \left( \text{incompressibility constraint} \right).\]</div>
<p>Since the incompressibility constraint is defined at cell center, we need to interpolate them to the cell face in-between:</p>
<div class="math notranslate nohighlight">
\[\vat{
   \dder{u_i}{x_i}
}{\xic, \xjc}
=
\vat{
   \dintrpu{
      \dder{u_i}{x_i}
   }{x}
}{\xic, \xjc}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pre-factor <span class="math notranslate nohighlight">\(\vat{\ux}{\xic,\xjc}\)</span> in front of the incompressibility constraint is controversial since there are mainly two possibilities:</p>
<ol class="arabic">
<li><p>Use local value at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span></p>
<div class="math notranslate nohighlight">
\[\vat{
   \left(
      \ux
      \dintrpu{
         \dder{u_i}{x_i}
      }{x}
   \right)
}{\xic, \xjc}\]</div>
</li>
<li><p>Interpolate as well as the incompressibility constraint</p>
<div class="math notranslate nohighlight">
\[\vat{
   \dintrpu{
      \left(
         \dintrpa{\ux}{x}
         \dder{u_i}{x_i}
      \right)
   }{x}
}{\xic, \xjc}\]</div>
</li>
</ol>
<p>To answer this question, we focus on the <span class="math notranslate nohighlight">\(y\)</span> component <span class="math notranslate nohighlight">\(\uy \der{\ux}{y}\)</span>.
As shown in the divergence form, three <span class="math notranslate nohighlight">\(\ux\)</span> are involved: <span class="math notranslate nohighlight">\(\vat{\ux}{\xic,\xjp}\)</span>, <span class="math notranslate nohighlight">\(\vat{\ux}{\xic,\xjc}\)</span>, and <span class="math notranslate nohighlight">\(\vat{\ux}{\xic,\xjm}\)</span>, which are on the same <span class="math notranslate nohighlight">\(x\)</span> cell face.
If we adopt the second option, two additional <span class="math notranslate nohighlight">\(\ux\)</span> components located at different <span class="math notranslate nohighlight">\(x\)</span> cell faces are involved.
This is obviously inconsistent, because the divergence and gradient forms, which are essentially identical, contain different <span class="math notranslate nohighlight">\(\ux\)</span> information.</p>
<p>Thus we should adopt the first option.</p>
</div>
<p>In order to go further, we let</p>
<div class="math notranslate nohighlight">
\[\vat{\dintrpu{q}{x}}{\xic}
=
\vat{C}{\xip} \vat{q}{\xip}
+
\vat{C}{\xim} \vat{q}{\xim}.\]</div>
<p>Since they are linear operation, interpolations and differentiations should be interchangeable, i.e.,</p>
<div class="math notranslate nohighlight">
\[\dintrpu{
   \dder{\ux}{x}
}{x}
=
\dder{
   \dintrpu{\ux}{x}
}{x},
\dintrpu{
   \dder{\uy}{y}
}{x}
=
\dder{
   \dintrpu{\uy}{x}
}{y}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We replace <span class="math notranslate nohighlight">\(\dintrpu{q}{x}\)</span> by <span class="math notranslate nohighlight">\(\dintrpa{q}{x}\)</span> since the interpolation is shifted to cell centers.</p>
</div>
<p>The second relation is obvious since operations in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions are independent.</p>
<p>In order to satisfy the first relation, <span class="math notranslate nohighlight">\(\vat{C}{\xip}\)</span> and <span class="math notranslate nohighlight">\(\vat{C}{\xim}\)</span> should be properly determined.
The interpolation of differentiations leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{
   \dintrpu{
      \dder{\ux}{x}
   }{x}
}{\xic, \xjc}
&amp; =
\vat{C}{\xip} \vat{\dder{\ux}{x}}{\xip, \xjc}
+
\vat{C}{\xim} \vat{\dder{\ux}{x}}{\xim, \xjc} \\
&amp; =
\vat{C}{\xip} \frac{
   \vat{\ux}{\xipp, \xjc}
   -
   \vat{\ux}{\xic,  \xjc}
}{\Delta x_{\xip}}
+
\vat{C}{\xim} \frac{
   \vat{\ux}{\xic,  \xjc}
   -
   \vat{\ux}{\ximm, \xjc}
}{\Delta x_{\xim}},\end{split}\]</div>
<p>while the differentiation of interpolations leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{
   \dder{
      \dintrpu{\ux}{x}
   }{x}
}{\xic, \xjc}
&amp; =
\frac{
   \vat{\dintrpu{\ux}{x}}{\xip, \xjc}
   -
   \vat{\dintrpu{\ux}{x}}{\xim, \xjc}
}{\Delta x_{\xic}} \\
&amp; =
\frac{
   \vat{\dintrpa{\ux}{x}}{\xip, \xjc}
   -
   \vat{\dintrpa{\ux}{x}}{\xim, \xjc}
}{\Delta x_{\xic}} \\
&amp; =
\frac{
   \frac{
      \vat{\ux}{\xipp, \xjc}
      +
      \vat{\ux}{\xic,  \xjc}
   }{2}
   -
   \frac{
      \vat{\ux}{\xic,  \xjc}
      +
      \vat{\ux}{\ximm, \xjc}
   }{2}
}{\Delta x_{\xic}}.\end{split}\]</div>
<p>By comparing these two equations, we notice</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vat{C}{\xip}
&amp; =
\frac{\Delta x_{\xip}}{2 \Delta x_{\xic}}, \\
\vat{C}{\xim}
&amp; =
\frac{\Delta x_{\xim}}{2 \Delta x_{\xic}},\end{split}\]</div>
<p>which is nothing else but <span class="math notranslate nohighlight">\(\dintrpv{q}{x}\)</span>.</p>
<p>Thus the gradient form leads,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ux \dder{\ux}{x}
&amp; =
\dder{\ux \ux}{x}
-
\ux \dder{\ux}{x} \\
&amp; =
\dder{
   \dintrpa{\ux}{x}
   \dintrpa{\ux}{x}
}{x}
-
\ux \dintrpv{
   \dder{\ux}{x}
}{x} \\
&amp; =
\dder{
   \dintrpa{\ux}{x}
   \dintrpa{\ux}{x}
}{x}
-
\ux \dder{
   \dintrpa{\ux}{x}
}{x} \\
&amp; =
\frac{
   \vat{\left(
      \dintrpa{\ux}{x}
      \dintrpa{\ux}{x}
   \right)}{\xip, \xjc}
   -
   \vat{\left(
      \dintrpa{\ux}{x}
      \dintrpa{\ux}{x}
   \right)}{\xim, \xjc}
}{\Delta x_{\xic}}
-
\vat{\ux}{\xic, \xjc}
\frac{
   \vat{\dintrpa{\ux}{x}}{\xip, \xjc}
   -
   \vat{\dintrpa{\ux}{x}}{\xim, \xjc}
}{\Delta x_{\xic}} \\
&amp; =
\vat{\dintrpa{\ux}{x}}{\xip, \xjc}
\frac{
   \vat{\dintrpa{\ux}{x}}{\xip, \xjc}
   -
   \vat{\ux}{\xic, \xjc}
}{\Delta x_{\xic}}
-
\vat{\dintrpa{\ux}{x}}{\xim, \xjc}
\frac{
   \vat{\dintrpa{\ux}{x}}{\xim, \xjc}
   -
   \vat{\ux}{\xic, \xjc}
}{\Delta x_{\xic}} \\
&amp; =
\vat{\dintrpa{\ux}{x}}{\xip, \xjc}
\frac{1}{\Delta x_{\xic}} \frac{
   \vat{\diffe{\ux}{x}}{\xip, \xjc}
}{2}
+
\vat{\dintrpa{\ux}{x}}{\xim, \xjc}
\frac{1}{\Delta x_{\xic}} \frac{
   \vat{\diffe{\ux}{x}}{\xim, \xjc}
}{2} \\
&amp; =
\frac{\Delta x_{\xip}}{2 \Delta x_{\xic}}
\vat{\left( \dintrpa{\ux}{x} \dder{\ux}{x} \right)}{\xip, \xjc}
+
\frac{\Delta x_{\xim}}{2 \Delta x_{\xic}}
\vat{\left( \dintrpa{\ux}{x} \dder{\ux}{x} \right)}{\xim, \xjc} \\
&amp; =
\vat{C}{\xip}
\vat{\left( \dintrpa{\ux}{x} \dder{\ux}{x} \right)}{\xip, \xjc}
+
\vat{C}{\xim}
\vat{\left( \dintrpa{\ux}{x} \dder{\ux}{x} \right)}{\xim, \xjc} \\
&amp; =
\color{red}{
   \vat{
      \dintrpv{
         \dintrpa{\ux}{x} \dder{\ux}{x}
      }{x}
   }{\xic, \xjc}
}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\uy \dder{\ux}{x}
&amp; =
\dder{\uy \ux}{x}
-
\uy \dder{\ux}{x} \\
&amp; =
\dder{
   \dintrpv{\uy}{x}
   \dintrpa{\ux}{y}
}{y}
-
\ux \dintrpv{
   \dder{\uy}{y}
}{x} \\
&amp; =
\dder{
   \dintrpv{\uy}{x}
   \dintrpa{\ux}{y}
}{y}
-
\ux \dder{
   \dintrpv{\uy}{x}
}{y} \\
&amp; =
\frac{
   \vat{
      \left(
         \dintrpv{\uy}{x}
         \dintrpa{\ux}{y}
      \right)
   }{\xic, \xjp}
   -
   \vat{
      \left(
         \dintrpv{\uy}{x}
         \dintrpa{\ux}{y}
      \right)
   }{\xic, \xjm}
}{\Delta y}
-
\vat{
   \ux
}{\xic, \xjc}
\frac{
   \vat{
      \dintrpv{\uy}{x}
   }{\xic, \xjp}
   -
   \vat{
      \dintrpv{\uy}{x}
   }{\xic, \xjm}
}{\Delta y} \\
&amp; =
\vat{\dintrpv{\uy}{x}}{\xic, \xjp}
\frac{
   \vat{\dintrpa{\ux}{y}}{\xic, \xjp}
   -
   \vat{\ux}{\xic, \xjc}
}{\Delta y}
-
\vat{\dintrpv{\uy}{x}}{\xic, \xjm}
\frac{
   \vat{\dintrpa{\ux}{y}}{\xic, \xjm}
   -
   \vat{\ux}{\xic, \xjc}
}{\Delta y} \\
&amp; =
\frac{1}{2}
\vat{
   \left(
      \dintrpv{\uy}{x}
      \dder{\ux}{y}
   \right)
}{\xic, \xjp}
+
\frac{1}{2} \vat{
   \left(
      \dintrpv{\uy}{x}
      \dder{\ux}{y}
   \right)
}{\xic, \xjm} \\
&amp; =
\color{red}{
   \vat{
      \dintrpa{
         \dintrpv{\uy}{x}
         \dder{\ux}{y}
      }{y}
   }{\xic, \xjc}
}.\end{split}\]</div>
</li>
<li><p>Advection of <span class="math notranslate nohighlight">\(\uy\)</span></p>
<p>The gradient form</p>
<div class="math notranslate nohighlight">
\[\ux \dder{\uy}{x}
+
\uy \dder{\uy}{y}\]</div>
<p>is defined at <span class="math notranslate nohighlight">\(y\)</span> cell face <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span> and  is written as</p>
<div class="math notranslate nohighlight">
\[\dder{\ux \uy}{x}
+
\dder{\uy \uy}{y}
-
\uy \left(
   \dder{\ux}{x}
   +
   \dder{\uy}{y}
\right)\]</div>
<p>i.e.,</p>
<div class="math notranslate nohighlight">
\[\left( \text{divergence form} \right) - \uy \left( \text{incompressibility constraint} \right).\]</div>
<p>Since the incompressibility constraint is defined at cell center, we need to interpolate them to the cell face in-between:</p>
<div class="math notranslate nohighlight">
\[\vat{
   \dder{u_i}{x_i}
}{\yic, \yjc}
=
\vat{
   \dintrpa{
      \dder{u_i}{x_i}
   }{y}
}{\yic, \yjc}.\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ux \dder{\uy}{x}
&amp; =
\dder{\ux \uy}{x}
-
\uy \dder{\ux}{x} \\
&amp; =
\dder{
   \dintrpa{\ux}{y}
   \dintrpa{\uy}{x}
}{x}
-
\uy \dintrpa{
   \dder{\ux}{x}
}{y} \\
&amp; =
\dder{
   \dintrpa{\ux}{y}
   \dintrpa{\uy}{x}
}{x}
-
\uy \dder{
   \dintrpa{\ux}{y}
}{x} \\
&amp; =
\frac{
   \vat{\left(
      \dintrpa{\ux}{y}
      \dintrpa{\uy}{x}
   \right)}{\yip, \yjc}
   -
   \vat{\left(
      \dintrpa{\ux}{y}
      \dintrpa{\uy}{x}
   \right)}{\yim, \yjc}
}{\Delta x_{\yic}}
-
\vat{\uy}{\yic, \yjc}
\frac{
   \vat{\dintrpa{\ux}{y}}{\yip, \yjc}
   -
   \vat{\dintrpa{\ux}{y}}{\yim, \yjc}
}{\Delta x_{\yic}} \\
&amp; =
\vat{\dintrpa{\ux}{y}}{\yip, \yjc}
\frac{
   \vat{\dintrpa{\uy}{x}}{\yip, \yjc}
   -
   \vat{\uy}{\yic, \yjc}
}{\Delta x_{\yic}}
-
\vat{\dintrpa{\ux}{y}}{\yim, \yjc}
\frac{
   \vat{\dintrpa{\uy}{x}}{\yim, \yjc}
   -
   \vat{\uy}{\yic, \yjc}
}{\Delta x_{\yic}} \\
&amp; =
\vat{\dintrpa{\ux}{y}}{\yip, \yjc}
\frac{1}{\Delta x_{\yic}} \frac{
   \vat{\diffe{\uy}{x}}{\yip, \yjc}
}{2}
+
\vat{\dintrpa{\ux}{y}}{\yim, \yjc}
\frac{1}{\Delta x_{\yic}} \frac{
   \vat{\diffe{\uy}{x}}{\yim, \yjc}
}{2} \\
&amp; =
\frac{\Delta x_{\yip}}{2 \Delta x_{\yic}}
\vat{\left( \dintrpa{\ux}{y} \dder{\uy}{x} \right)}{\yip, \yjc}
+
\frac{\Delta x_{\yim}}{2 \Delta x_{\yic}}
\vat{\left( \dintrpa{\ux}{y} \dder{\uy}{x} \right)}{\yim, \yjc} \\
&amp; =
\vat{C}{\yip}
\vat{\left( \dintrpa{\ux}{y} \dder{\uy}{x} \right)}{\yip, \yjc}
+
\vat{C}{\yim}
\vat{\left( \dintrpa{\ux}{y} \dder{\uy}{x} \right)}{\yim, \yjc} \\
&amp; =
\color{red}{
   \vat{
      \dintrpv{
         \dintrpa{\ux}{y} \dder{\uy}{x}
      }{x}
   }{\yic, \yjc}
}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\uy \dder{\uy}{y}
&amp; =
\dder{\uy \uy}{y}
-
\uy \dder{\uy}{y} \\
&amp; =
\dder{
   \dintrpa{\uy}{y}
   \dintrpa{\uy}{y}
}{y}
-
\uy \dintrpa{
   \dder{\uy}{y}
}{y} \\
&amp; =
\dder{
   \dintrpa{\uy}{y}
   \dintrpa{\uy}{y}
}{y}
-
\uy \dder{
   \dintrpa{\uy}{y}
}{y} \\
&amp; =
\frac{
   \vat{
      \left(
         \dintrpa{\uy}{y}
         \dintrpa{\uy}{y}
      \right)
   }{\yic, \yjp}
   -
   \vat{
      \left(
         \dintrpa{\uy}{y}
         \dintrpa{\uy}{y}
      \right)
   }{\yic, \yjm}
}{\Delta y}
-
\vat{
   \uy
}{\yic, \yjc}
\frac{
   \vat{
      \dintrpa{\uy}{y}
   }{\yic, \yjp}
   -
   \vat{
      \dintrpa{\uy}{y}
   }{\yic, \yjm}
}{\Delta y} \\
&amp; =
\vat{\dintrpa{\uy}{y}}{\yic, \yjp}
\frac{
   \vat{\dintrpa{\uy}{y}}{\yic, \yjp}
   -
   \vat{\uy}{\yic, \yjc}
}{\Delta y}
-
\vat{\dintrpa{\uy}{y}}{\yic, \yjm}
\frac{
   \vat{\dintrpa{\uy}{y}}{\yic, \yjm}
   -
   \vat{\uy}{\yic, \yjc}
}{\Delta y} \\
&amp; =
\frac{1}{2} \vat{
   \left(
      \dintrpa{\uy}{y}
      \dder{\uy}{y}
   \right)
}{\yic, \yjp}
+
\frac{1}{2} \vat{
   \left(
      \dintrpa{\uy}{y}
      \dder{\uy}{y}
   \right)
}{\yic, \yjm} \\
&amp; =
\color{red}{
   \vat{
      \dintrpa{
         \dintrpa{\uy}{y}
         \dder{\uy}{y}
      }{y}
   }{\yic, \yjc}
}.\end{split}\]</div>
</li>
</ol>
</details></section>
</section>
<section id="pressure-gradient-terms">
<h3>Pressure-gradient terms<a class="headerlink" href="#pressure-gradient-terms" title="Permalink to this heading">¶</a></h3>
<p>Since they are simple gradients, we discretise them as</p>
<div class="math notranslate nohighlight">
\[\vat{\dder{p}{x}}{\xic, \xjc},
\vat{\dder{p}{y}}{\yic, \yjc}\]</div>
<p>in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions, respectively.</p>
</section>
<section id="diffusive-terms">
<h3>Diffusive terms<a class="headerlink" href="#diffusive-terms" title="Permalink to this heading">¶</a></h3>
<p>These terms <em>diffuse</em> the momentum in all directions.
Also, they play a crucial role to (diffuse and) <em>dissipate</em> the kinetic energy.
In this project, all injected energy should be eventually dissipated by them since there is no other energy sink.</p>
<section id="diffusion-of-ux-and-uy">
<h4>1. Diffusion of <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span><a class="headerlink" href="#diffusion-of-ux-and-uy" title="Permalink to this heading">¶</a></h4>
<p>Since they are linear (and thus we can treat them implicitly in time, see <a class="reference internal" href="../../temporal_discretisation/index.html#temporal-discretisation"><span class="std std-ref">the temporal discretisation</span></a>), we can simply discretise them as</p>
<div class="math notranslate nohighlight">
\[\frac{\sqrt{Pr}}{\sqrt{Ra}} \left\{
   \dder{}{x} \left( \dder{\ux}{x} \right)
   +
   \dder{}{y} \left( \dder{\ux}{y} \right)
\right\}\]</div>
<p>in <span class="math notranslate nohighlight">\(x\)</span> direction at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> where <span class="math notranslate nohighlight">\(\ux\)</span> is defined, while</p>
<div class="math notranslate nohighlight">
\[\frac{\sqrt{Pr}}{\sqrt{Ra}} \left\{
   \dder{}{x} \left( \dder{\uy}{x} \right)
   +
   \dder{}{y} \left( \dder{\uy}{y} \right)
\right\}\]</div>
<p>in <span class="math notranslate nohighlight">\(y\)</span> direction at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span> where <span class="math notranslate nohighlight">\(\uy\)</span> is defined.
All first-order differentiations are defined where needed and thus no interpolation is necessary.</p>
</section>
<section id="dissipation-of-k">
<h4>2. Dissipation of <span class="math notranslate nohighlight">\(k\)</span><a class="headerlink" href="#dissipation-of-k" title="Permalink to this heading">¶</a></h4>
<p>Discrete form of <span class="math notranslate nohighlight">\(\der{u_i}{x_j} \der{u_i}{x_j}\)</span>, which are used to compute the dissipation rate of the kinetic energy, are discretised, which are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( \der{\ux}{x} \right)^2
+
\left( \der{\ux}{y} \right)^2
\approx &amp;
s_{xx} s_{xx}
+
s_{xy} s_{xy} \\
\equiv &amp;
\frac{1}{2}
\frac{1}{\Delta x_{\xic}}
\vat{
   \diffe{\ux}{x}
}{\xip, \xjc}
\vat{
   \dder{\ux}{x}
}{\xip, \xjc}
+
\frac{1}{2}
\frac{1}{\Delta x_{\xic}}
\vat{
   \diffe{\ux}{x}
}{\xim, \xjc}
\vat{
   \dder{\ux}{x}
}{\xim, \xjc} \\
+ &amp;
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\ux}{y}
}{\xic, \xjp}
\vat{
   \dder{\ux}{y}
}{\xic, \xjp}
+
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\ux}{y}
}{\xic, \xjm}
\vat{
   \dder{\ux}{y}
}{\xic, \xjm}\end{split}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>, and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( \der{\uy}{x} \right)^2
+
\left( \der{\uy}{y} \right)^2
\approx &amp;
s_{yx} s_{yx}
+
s_{yy} s_{yy} \\
\equiv &amp;
\vat{C}{\yip}
\frac{1}{\Delta x_{\yic}}
\vat{
   \diffe{\uy}{x}
}{\yip, \yjc}
\vat{
   \dder{\uy}{x}
}{\yip, \yjc}
+
\vat{C}{\yim}
\frac{1}{\Delta x_{\yic}}
\vat{
   \diffe{\uy}{x}
}{\yim, \yjc}
\vat{
   \dder{\uy}{x}
}{\yim, \yjc} \\
+ &amp;
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\uy}{y}
}{\yic, \yjp}
\vat{
   \dder{\uy}{y}
}{\yic, \yjp}
+
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{\uy}{y}
}{\yic, \yjm}
\vat{
   \dder{\uy}{y}
}{\yic, \yjm}\end{split}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>.</p>
<details>
<summary>
Derivations</summary><p>In <a class="reference internal" href="../../../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a> (for continuous domain), we took the inner product of <span class="math notranslate nohighlight">\(u_i\)</span> and the momentum balance to derive the relation of the diffusion and dissipation of <span class="math notranslate nohighlight">\(k\)</span>:</p>
<div class="math notranslate nohighlight">
\[u_i \der{}{x_j} \left( \der{u_i}{x_j} \right)
=
\der{}{x_j} \left( u_i \der{u_i}{x_j} \right)
-
\der{u_i}{x_j} \der{u_i}{x_j},\]</div>
<p>where pre-factors <span class="math notranslate nohighlight">\(\sqrt{Pr} / \sqrt{Ra}\)</span> are dropped for convenience.
Here we consider the counterpart in the discrete space.</p>
<p>First, we focus on the contribution of the momentum in <span class="math notranslate nohighlight">\(x\)</span> direction.
At <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>, the left-hand-side is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ux
\left\{
   \dder{}{x} \left( \dder{\ux}{x} \right)
   +
   \dder{}{y} \left( \dder{\ux}{y} \right)
\right\}
&amp; =
\frac{
   \vat{\ux}{\xic, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xip, \xjc}
   -
   \vat{\ux}{\xic, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xim, \xjc}
}{\Delta x_{\xic}} \\
&amp; +
\frac{
   \vat{\ux}{\xic, \xjc}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjp}
   -
   \vat{\ux}{\xic, \xjc}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjm}
}{\Delta y},\end{split}\]</div>
<p>while the first term in the right-hand-side (diffusion of <span class="math notranslate nohighlight">\(\ux^2/2\)</span>) leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\dder{}{x} \left( \ux \dder{\ux}{x} \right)
+
\dder{}{y} \left( \ux \dder{\ux}{y} \right)
&amp; =
\frac{
   \vat{
      \dintrpa{\ux}{x}
   }{\xip, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xip, \xjc}
   -
   \vat{
      \dintrpa{\ux}{x}
   }{\xim, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xim, \xjc}
}{\Delta x_{\xic}} \\
&amp; +
\frac{
   \vat{
      \dintrpa{\ux}{y}
   }{\xic, \xjp}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjp}
   -
   \vat{
      \dintrpa{\ux}{y}
   }{\xic, \xjm}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjm}
}{\Delta y}.\end{split}\]</div>
<p>Subtracting the first equation from the second one yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\frac{
   \left(
      \vat{
         \dintrpa{\ux}{x}
      }{\xip, \xjc}
      -
      \vat{\ux}{\xic, \xjc}
   \right)
   \vat{
      \dder{\ux}{x}
   }{\xip, \xjc}
   -
   \left(
      \vat{
         \dintrpa{\ux}{x}
      }{\xim, \xjc}
      -
      \vat{\ux}{\xic, \xjc}
   \right)
   \vat{
      \dder{\ux}{x}
   }{\xim, \xjc}
}{\Delta x_{\xic}} \\
+ &amp;
\frac{
   \left(
      \vat{
         \dintrpa{\ux}{y}
      }{\xic, \xjp}
      -
      \vat{\ux}{\xic, \xjc}
   \right)
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjp}
   -
   \left(
      \vat{
         \dintrpa{\ux}{y}
      }{\xic, \xjm}
      -
      \vat{\ux}{\xic, \xjc}
   \right)
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjm}
}{\Delta y} \\
= &amp;
\color{red}{
   \frac{1}{2}
   \frac{1}{\Delta x_{\xic}}
   \vat{
      \diffe{\ux}{x}
   }{\xip, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xip, \xjc}
   +
   \frac{1}{2}
   \frac{1}{\Delta x_{\xic}}
   \vat{
      \diffe{\ux}{x}
   }{\xim, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xim, \xjc}
} \\
\color{red}{+} &amp;
\color{red}{
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{\ux}{y}
   }{\xic, \xjp}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjp}
   +
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{\ux}{y}
   }{\xic, \xjm}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjm}
}.\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We find that four contributions exist:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
   \text{left cell} \left( \xim, \xjc \right)
   &amp;
   \frac{1}{2}
   \frac{1}{\Delta x_{\xic}}
   \vat{
      \diffe{\ux}{x}
   }{\xim, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xim, \xjc} \\
   \text{right cell} \left( \xip, \xjc \right)
   &amp;
   \frac{1}{2}
   \frac{1}{\Delta x_{\xic}}
   \vat{
      \diffe{\ux}{x}
   }{\xip, \xjc}
   \vat{
      \dder{\ux}{x}
   }{\xip, \xjc} \\
   \text{bottom cell} \left( \xic, \xjm \right)
   &amp;
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{\ux}{y}
   }{\xic, \xjm}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjm} \\
   \text{top cell} \left( \xic, \xjp \right)
   &amp;
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{\ux}{y}
   }{\xic, \xjp}
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjp}
\end{cases}\end{split}\]</div>
<p>The bottom and top contributions are implemented directly in <a class="reference internal" href="../../../implementation/analyses.html#analyses"><span class="std std-ref">src/analyses.c</span></a>, while the left and right contributions need special attention.
On the left boundary, the left-cell contribution is null since it is inside the wall, while the right contribution remains.
The same notice holds for the right boundary.</p>
<p>If the boundary effects are neglected, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\frac{\Delta x_{\xip}}{2 \Delta x_{\xic}}
\left(
   \vat{
      \dder{\ux}{x}
   }{\xip, \xjc}
\right)^2
+
\frac{\Delta x_{\xim}}{2 \Delta x_{\xic}}
\left(
   \vat{
      \dder{\ux}{x}
   }{\xim, \xjc}
\right)^2 \\
+ &amp;
\frac{1}{2}
\left(
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjp}
\right)^2
+
\frac{1}{2}
\left(
   \vat{
      \dder{\ux}{y}
   }{\xic, \xjm}
\right)^2 \\
&amp; =
\dintrpv{
   \left(
      \dder{\ux}{x}
   \right)^2
}{x}
+
\dintrpa{
   \left(
      \dder{\ux}{y}
   \right)^2
}{y}.\end{split}\]</div>
</div>
<p>Similarly,</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\frac{
   \left(
      \vat{
         \dintrpa{\uy}{x}
      }{\yip, \yjc}
      -
      \vat{\uy}{\yic, \yjc}
   \right)
   \vat{
      \dder{\uy}{x}
   }{\yip, \yjc}
   -
   \left(
      \vat{
         \dintrpa{\uy}{x}
      }{\yim, \yjc}
      -
      \vat{\uy}{\yic, \yjc}
   \right)
   \vat{
      \dder{\uy}{x}
   }{\yim, \yjc}
}{\Delta x_{\yic}} \\
+ &amp;
\frac{
   \left(
      \vat{
         \dintrpa{\uy}{y}
      }{\yic, \yjp}
      -
      \vat{\uy}{\yic, \yjc}
   \right)
   \vat{
      \dder{\uy}{y}
   }{\yic, \yjp}
   -
   \left(
      \vat{
         \dintrpa{\uy}{y}
      }{\yic, \yjm}
      -
      \vat{\uy}{\yic, \yjc}
   \right)
   \vat{
      \dder{\uy}{y}
   }{\yic, \yjm}
}{\Delta y} \\
= &amp;
\color{red}{
   \vat{C}{\yip}
   \frac{1}{\Delta x_{\yic}}
   \vat{
      \diffe{\uy}{x}
   }{\yip, \yjc}
   \vat{
      \dder{\uy}{x}
   }{\yip, \yjc}
   +
   \vat{C}{\yim}
   \frac{1}{\Delta x_{\yic}}
   \vat{
      \diffe{\uy}{x}
   }{\yim, \yjc}
   \vat{
      \dder{\uy}{x}
   }{\yim, \yjc}
} \\
\color{red}{+} &amp;
\color{red}{
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{\uy}{y}
   }{\yic, \yjp}
   \vat{
      \dder{\uy}{y}
   }{\yic, \yjp}
   +
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{\uy}{y}
   }{\yic, \yjm}
   \vat{
      \dder{\uy}{y}
   }{\yic, \yjm}
},\end{split}\]</div>
<p>which is <span class="math notranslate nohighlight">\(\uy\)</span> contribution defined at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the boundary effects are neglected, we have</p>
<div class="math notranslate nohighlight">
\[\dintrpv{
   \left(
      \dder{\uy}{x}
   \right)^2
}{x}
+
\dintrpa{
   \left(
      \dder{\uy}{y}
   \right)^2
}{y}.\]</div>
</div>
<p>The reddish parts are computed in <a class="reference internal" href="../../../implementation/analyses.html#analyses"><span class="std std-ref">analyses_compute_kinetic_dissipation</span></a> since these quantities have direct relations with the dissipation rate of the kinetic energy.</p>
</details></section>
</section>
<section id="external-forcing-terms">
<h3>External forcing terms<a class="headerlink" href="#external-forcing-terms" title="Permalink to this heading">¶</a></h3>
<p>In the momentum balance, we have</p>
<div class="math notranslate nohighlight">
\[\dintrpu{T}{x}\]</div>
<p>in <span class="math notranslate nohighlight">\(x\)</span> direction at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span>, while <span class="math notranslate nohighlight">\(0\)</span> in <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<p>In the kinetic energy balance, we have</p>
<div class="math notranslate nohighlight">
\[\ux \dintrpu{T}{x}\]</div>
<p>in <span class="math notranslate nohighlight">\(x\)</span> direction at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>, while <span class="math notranslate nohighlight">\(0\)</span> in <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to replace <span class="math notranslate nohighlight">\(\dintrpu{T}{x}\)</span>, we need to focus on <a class="reference internal" href="nusselt_number_relations.html#nusselt-number-relations"><span class="std std-ref">the Nusselt number relations</span></a>.</p>
</div>
</section>
</section>
<section id="derivations-global-conservations">
<h2>Derivations - global conservations<a class="headerlink" href="#derivations-global-conservations" title="Permalink to this heading">¶</a></h2>
<p>In this part, we analyse the <em>global</em> properties of equations averaged in the whole volume, which plays a crucial role when we discuss <a class="reference internal" href="nusselt_number_relations.html#nusselt-number-relations"><span class="std std-ref">the energy balance of Rayleigh-Bénard convections</span></a>.</p>
<p>Following the above discussion, the evolutions of <span class="math notranslate nohighlight">\(\frac{1}{2} \ux^2\)</span> and <span class="math notranslate nohighlight">\(\frac{1}{2} \uy^2\)</span> lead</p>
<div class="math notranslate nohighlight">
\[\begin{split}\der{}{t} \left( \frac{1}{2} \ux^2 \right)
&amp; +
\dder{
   \dintrpa{\ux}{x}
   q_{xx}
}{x}
+
\dder{
   \dintrpv{\uy}{x}
   q_{xy}
}{y} \\
&amp; =
-\ux \dder{p}{x}
+
\frac{\sqrt{Pr}}{\sqrt{Ra}} \left\{
   \dder{}{x} \left( \ux \dder{\ux}{x} \right)
   +
   \dder{}{y} \left( \ux \dder{\ux}{y} \right)
\right\}
-
\frac{\sqrt{Pr}}{\sqrt{Ra}} \left(
   s_{xx} s_{xx}
   +
   s_{xy} s_{xy}
\right) \\
&amp; +
\ux \dintrpu{T}{x}\end{split}\]</div>
<p>defined at <span class="math notranslate nohighlight">\(\left( \xic, \xjc \right)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\der{}{t} \left( \frac{1}{2} \uy^2 \right)
&amp; +
\dder{
   \dintrpa{\ux}{y}
   q_{yx}
}{x}
+
\dder{
   \dintrpa{\uy}{y}
   q_{yy}
}{y} \\
&amp; =
-\uy \dder{p}{y}
+
\frac{\sqrt{Pr}}{\sqrt{Ra}} \left\{
   \dder{}{x} \left( \uy \dder{\uy}{x} \right)
   +
   \dder{}{y} \left( \uy \dder{\uy}{y} \right)
\right\}
-
\frac{\sqrt{Pr}}{\sqrt{Ra}} \left(
   s_{yx} s_{yx}
   +
   s_{yy} s_{yy}
\right)\end{split}\]</div>
<p>defined at <span class="math notranslate nohighlight">\(\left( \yic, \yjc \right)\)</span>.</p>
<p>Now we consider to integrate these equations in the whole volume to deduce the evolutions of the <em>total</em> <em>discrete</em> kinetic energy <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="math notranslate nohighlight">
\[K
\equiv
\sum_{i} \sum_{j}
\vat{
   \left( \frac{1}{2} \ux^2 \Delta x \Delta y \right)
}{\xic, \xjc}
+
\sum_{i} \sum_{j}
\vat{
   \left( \frac{1}{2} \uy^2 \Delta x \Delta y \right)
}{\yic, \yjc}.\]</div>
<p>As usual, conservative terms vanish.
Also the pressure gradients do not contribute to the net change in the kinetic energy.</p>
<details>
<summary>
Derivations</summary><p>Their contributions to the energy equation leads</p>
<div class="math notranslate nohighlight">
\[\int \ux \der{p}{x} dV
\approx
\sum_{i} \sum_{j}
\vat{
   \left(
      \ux \dder{p}{x} \Delta x \Delta y
   \right)
}{\xic, \xjc}\]</div>
<p>from the momentum balance in <span class="math notranslate nohighlight">\(x\)</span> direction, while</p>
<div class="math notranslate nohighlight">
\[\int \uy \der{p}{y} dV
\approx
\sum_{i} \sum_{J}
\vat{
   \left(
      \uy \dder{p}{y} \Delta x \Delta y
   \right)
}{\yic, \yjc}\]</div>
<p>from the momentum balance in <span class="math notranslate nohighlight">\(y\)</span> direction.
Note that the summation symbols are for all positions <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span> are defined, respectively.</p>
<p>They lead</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j}
\vat{\ux}{\xic, \xjc}
\frac{
   \vat{p}{\xip, \xjc}
   -
   \vat{p}{\xim, \xjc}
}{\Delta x_{\xic}}
\Delta x_{\xic}
\Delta y
=
\sum_{i} \sum_{j}
\vat{\ux}{\xic, \xjc}
\left(
   \vat{p}{\xip, \xjc}
   -
   \vat{p}{\xim, \xjc}
\right)
\Delta y,\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j}
\vat{\uy}{\yic, \yjc}
\frac{
   \vat{p}{\yic, \yjp}
   -
   \vat{p}{\yic, \yjm}
}{\Delta y}
\Delta x_{\yic}
\Delta y
=
\sum_{i} \sum_{j}
\vat{\uy}{\yic, \yjc}
\left(
   \vat{p}{\yic, \yjp}
   -
   \vat{p}{\yic, \yjm}
\right)
\Delta x_{\yic}.\]</div>
<p>Note that, although we write them as the sum of terms defined at <span class="math notranslate nohighlight">\(\ux\)</span> locations (<span class="math notranslate nohighlight">\(\sum \ux \left( \cdots \right)\)</span>) and <span class="math notranslate nohighlight">\(\uy\)</span> locations (<span class="math notranslate nohighlight">\(\sum \uy \left( \cdots \right)\)</span>), they can be written as the sum of terms defined at <span class="math notranslate nohighlight">\(p\)</span> locations (<span class="math notranslate nohighlight">\(\sum p \left( \cdots \right)\)</span>):</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j}
-
\vat{p}{\pic, \pjc}
\left(
   \vat{\ux}{\pip, \pjc}
   -
   \vat{\ux}{\pim, \pjc}
\right)
\Delta y\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j}
-
\vat{p}{\pic, \pjc}
\left(
   \vat{\uy}{\pic, \pjp}
   -
   \vat{\uy}{\pic, \pjm}
\right)
\Delta x_{\pic}.\]</div>
<p>Since they are defined at the same locations, we merge them as</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j}
-
\vat{p}{\pic, \pjc}
\vat{
   \left(
      \dder{\ux}{x}
      +
      \dder{\uy}{y}
   \right)
}{\pic, \pjc}
\Delta x_{\pic}
\Delta y,\]</div>
<p>which vanishes because of the continuity.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last equation is the discrete approximation of</p>
<div class="math notranslate nohighlight">
\[\int -p \der{u_i}{x_i} dV.\]</div>
</div>
</details><p>As a result, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\der{K}{t}
&amp; \equiv
\der{}{t} \sum_{i} \sum_{j} \vat{
   \left(
      \frac{1}{2} \ux^2 \Delta x \Delta y
   \right)
}{\xic, \xjc}
+
\der{}{t} \sum_{i} \sum_{j} \vat{
   \left(
      \frac{1}{2} \uy^2 \Delta x \Delta y
   \right)
}{\yic, \yjc} \\
&amp; =
\sum_{i} \sum_{j}
\vat{
   \left[
      \left\{
         -
         \frac{\sqrt{Pr}}{\sqrt{Ra}} \left(
            s_{xx} s_{xx}
            +
            s_{xy} s_{xy}
         \right)
         +
         \ux \dintrpu{T}{x}
      \right\}
      \Delta x \Delta y
   \right]
}{\xic, \xjc} \\
&amp; +
\sum_{i} \sum_{j}
\vat{
   \left[
      \left\{
         -
         \frac{\sqrt{Pr}}{\sqrt{Ra}} \left(
            s_{yx} s_{yx}
            +
            s_{yy} s_{yy}
         \right)
      \right\}
      \Delta x \Delta y
   \right]
}{\yic, \yjc}.\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a statistically-steady state where the temporal dependencies vanish, we find that the energy injection by the buoyancy force is balanced by the kinetic dissipation.</p>
</div>
<details>
<summary>
When the walls move</summary><p>It would be useful to derive the relation when the walls are not at rest, i.e., <span class="math notranslate nohighlight">\(\vat{\uy}{\text{left wall}} \ne 0, \vat{\uy}{\text{right wall}} \ne 0\)</span>.
In this case, when being integrated in the whole volume, the diffusive terms in <span class="math notranslate nohighlight">\(x\)</span> direction lead</p>
<div class="math notranslate nohighlight">
\[\sum_j \vat{
   \left(
      \frac{\sqrt{Pr}}{\sqrt{Ra}} \left[
         \ux \dder{\ux}{x}
      \right]_{\text{left wall}}^{\text{right wall}} \Delta y
   \right)
}{\xic, \xjc},
\sum_j \vat{
   \left(
      \frac{\sqrt{Pr}}{\sqrt{Ra}} \left[
         \uy \dder{\uy}{x}
      \right]_{\text{left wall}}^{\text{right wall}} \Delta y
   \right)
}{\yic, \yjc},\]</div>
<p>respectively.</p>
<p>Being regardless of the wall motions, impermeable walls impose <span class="math notranslate nohighlight">\(\ux \equiv 0\)</span> and thus the first term vanishes anyway (permeable walls are out of focus now).</p>
<p>Regarding the second term, <span class="math notranslate nohighlight">\(\uy\)</span> on the walls are given as the boundary conditions and thus the integrand can be linearised.
<span class="math notranslate nohighlight">\(\frac{\sqrt{Pr}}{\sqrt{Ra}} \dder{\uy}{x}\)</span> on the walls are the discrete shear stress on the walls which are evaluated when computing the diffusive term in the momentum balance.</p>
</details></section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Naoki Hori.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/numerical_method/spatial_discretisation/discrete_governing_equations/momentum_balance_and_quadratic_quantity.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>