
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Thermal energy balance and quadratic quantity &#8212; Simple Navier-Stokes Solver 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"der": ["{\\frac{\\partial #1}{\\partial #2}}", 2], "dder": ["{\\frac{\\delta #1}{\\delta #2}}", 2], "mst": ["{\\gamma^{#1 #2}}", 2], "gx": ["{\\xi}"], "gy": ["{\\eta}"], "ux": ["{u_x}"], "uy": ["{u_y}"], "intrp": ["{\\overline{#1}^{#2}}", 2], "diffe": ["{\\delta_{#2} {#1}}", 2], "vat": ["{\\left. {#1} \\right|_{#2}}", 2], "ave": ["{\\left\\langle {#1} \\right\\rangle_{#2}}", 2], "pimm": ["i-1           "], "pim": ["i-\\frac{1}{2}"], "pic": ["i             "], "pip": ["i+\\frac{1}{2}"], "pipp": ["i+1           "], "pjmm": ["j-1           "], "pjm": ["j-\\frac{1}{2}"], "pjc": ["j             "], "pjp": ["j+\\frac{1}{2}"], "pjpp": ["j+1           "], "ximm": ["i-\\frac{1}{2}"], "xim": ["i             "], "xic": ["i+\\frac{1}{2}"], "xip": ["i+1           "], "xipp": ["i+\\frac{3}{2}"], "xjmm": ["j-1           "], "xjm": ["j-\\frac{1}{2}"], "xjc": ["j             "], "xjp": ["j+\\frac{1}{2}"], "xjpp": ["j+1           "], "yimm": ["i-1           "], "yim": ["i-\\frac{1}{2}"], "yic": ["i             "], "yip": ["i+\\frac{1}{2}"], "yipp": ["i+1           "], "yjmm": ["j-\\frac{1}{2}"], "yjm": ["j             "], "yjc": ["j+\\frac{1}{2}"], "yjp": ["j+1           "], "yjpp": ["j+\\frac{3}{2}"], "dintrpa": ["{\\overline{#1}^{#2}}", 2], "dintrpv": ["{\\widehat {#1}^{#2}}", 2], "dintrpu": ["{\\widetilde {#1}^{#2}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Nusselt number relations" href="nusselt_number_relations.html" />
    <link rel="prev" title="Momentum balance and quadratic quantity" href="momentum_balance_and_quadratic_quantity.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Simple Navier-Stokes Solver</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NaokiHori&repo=SimpleNavierStokesSolver&type=true&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governing_equations/index.html">Governing equations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Numerical method</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../temporal_discretisation/index.html">Temporal discretisation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Spatial discretisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../implementation/index.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Numerical method</a><ul>
  <li><a href="../index.html">Spatial discretisation</a><ul>
  <li><a href="index.html">Discrete governing equations</a><ul>
      <li>Previous: <a href="momentum_balance_and_quadratic_quantity.html" title="previous chapter">Momentum balance and quadratic quantity</a></li>
      <li>Next: <a href="nusselt_number_relations.html" title="next chapter">Nusselt number relations</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="thermal-energy-balance-and-quadratic-quantity">
<span id="thermal-energy-balance"></span><h1>Thermal energy balance and quadratic quantity<a class="headerlink" href="#thermal-energy-balance-and-quadratic-quantity" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>In this part, we consider to discretise</p>
<div class="math notranslate nohighlight">
\[\der{T}{t}
+
u_i \der{T}{x_i}
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \frac{\partial^2 T}{\partial x_i \partial x_i}\]</div>
<p>at cell center <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span>.</p>
<p>Also a relevant (dependent) balance of the quadratic quantity</p>
<div class="math notranslate nohighlight">
\[\der{h}{t}
+
u_i \der{h}{x_i}
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \der{}{x_i} \left( T \der{T}{x_i} \right)
-
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \der{T}{x_i} \der{T}{x_i}\]</div>
<p>is considered.
Note that this can be obtained by multiplying the temperature <span class="math notranslate nohighlight">\(T\)</span> and the thermal energy balance, whose derivation in the continuous domain can be found in <a class="reference internal" href="../../../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a>.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h2>
<p>The following discrete equations are directly implemented in the code.</p>
<div class="math notranslate nohighlight">
\[\der{T}{t}
+
\dintrpv{
   \ux
   \dder{T}{x}
}{x}
+
\dintrpa{
   \uy
   \dder{T}{y}
}{y}
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left\{
   \dder{}{x} \left( \dder{T}{x} \right)
   +
   \dder{}{y} \left( \dder{T}{y} \right)
\right\},\]</div>
<p>which is defined at <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span>.</p>
<p>The implementation can be found in <a class="reference internal" href="../../../implementation/temperature/update.html#temperature-update"><span class="std std-ref">src/temperature/update.c</span></a>.</p>
</section>
<section id="derivations-local-conservations">
<h2>Derivations - local conservations<a class="headerlink" href="#derivations-local-conservations" title="Permalink to this heading">¶</a></h2>
<p>In this part, we focus on the <em>local</em> property of equations, e.g., how each term is discretised to make it <a class="reference internal" href="basic_operators.html#basic-operators"><span class="std std-ref">conservative</span></a>.
This is necessary to discuss the <em>global</em> properties (after being integrated in the volume), which will be discussed later.</p>
<section id="advective-terms">
<h3>Advective terms<a class="headerlink" href="#advective-terms" title="Permalink to this heading">¶</a></h3>
<p>Similar to the momentum balance, these terms should not alter the total amount of <span class="math notranslate nohighlight">\(T\)</span> as well as <span class="math notranslate nohighlight">\(h\)</span>.
We should keep this property even after being discretised.</p>
<p>Derivations are given below.</p>
<section id="divergence-form-of-advective-terms">
<h4>1. Divergence form of advective terms<a class="headerlink" href="#divergence-form-of-advective-terms" title="Permalink to this heading">¶</a></h4>
<p>We find the discrete form of the advection of <span class="math notranslate nohighlight">\(T\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[\dder{\ux \dintrpu{T}{x}}{x}
+
\dder{\uy \dintrpa{T}{y}}{y},\]</div>
<p>where <span class="math notranslate nohighlight">\(\dintrpu{T}{x}\)</span> has not been defined yet.</p>
<details>
<summary>
Derivations</summary><p>As being derived in <a class="reference internal" href="../../../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a>, the advection of the temperature is described as</p>
<div class="math notranslate nohighlight">
\[u_i \der{T}{x_i},\]</div>
<p>which is the so-called <em>gradient form</em>.
Thanks to the incompressibility constraint, this term can be written in a conservative form as</p>
<div class="math notranslate nohighlight">
\[u_i \der{T}{x_i}
+
T \der{u_i}{x_i}
=
\der{u_i T}{x_i},\]</div>
<p>whose right-hand-side is named as the <em>divergence form</em>.</p>
<p>Since the divergence form is inherently conservative, we obtain a discrete form of the advective term as</p>
<div class="math notranslate nohighlight">
\[\dder{u_i T}{x_i}
=
\dder{\ux \dintrpu{T}{x}}{x}
+
\dder{\uy \dintrpu{T}{y}}{y},\]</div>
<p>which is defined at cell center <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interpolations are not necessary for the velocities <span class="math notranslate nohighlight">\(\ux\)</span> and <span class="math notranslate nohighlight">\(\uy\)</span> since they are defined at cell faces.</p>
</div>
<p>Because of the uniform grid spacings in <span class="math notranslate nohighlight">\(y\)</span> direction, the interpolation in <span class="math notranslate nohighlight">\(y\)</span> direction can be replaced by an arithmetic average, giving</p>
<div class="math notranslate nohighlight">
\[\dder{u_i T}{x_i}
=
\dder{\ux \dintrpu{T}{x}}{x}
+
\dder{\uy \dintrpa{T}{y}}{y}.\]</div>
<p>In order to obtain an explicit form of the interpolation in <span class="math notranslate nohighlight">\(x\)</span> direction, we investigate the advection of <span class="math notranslate nohighlight">\(h\)</span>.</p>
</details></section>
<section id="advection-of-quadratic-quantities">
<h4>2. Advection of quadratic quantities<a class="headerlink" href="#advection-of-quadratic-quantities" title="Permalink to this heading">¶</a></h4>
<p>We find the discrete form of the advection of <span class="math notranslate nohighlight">\(T\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[\dder{\ux \dintrpa{T}{x}}{x}
+
\dder{\uy \dintrpa{T}{y}}{y},\]</div>
<p>where the interpolation which was undefined is defined.</p>
<details>
<summary>
Derivations</summary><p>As shown in <a class="reference internal" href="../../../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a>, this can be represented by multiplying the advective terms of the temperature by <span class="math notranslate nohighlight">\(T\)</span>.
The discrete counterpart is twofold,</p>
<div class="math notranslate nohighlight">
\[T \dder{\ux \dintrpu{T}{x}}{x}
=
\color{blue}{
\vat{
   T
}{\pic, \pjc}
}
\frac{
   \color{blue}{
   \vat{\ux}{\pip, \pjc}
   }
   \left(
      \color{blue}{
      \vat{c^+}{\pipp} \vat{T}{\pipp, \pjc}
      }
      +
      \vat{c^+}{\pic } \vat{T}{\pic,  \pjc}
   \right)
   -
   \color{blue}{
   \vat{\ux}{\pim, \pjc}
   }
   \left(
      \vat{c^-}{\pic } \vat{T}{\pic,  \pjc}
      +
      \color{blue}{
      \vat{c^-}{\pimm} \vat{T}{\pimm, \pjc}
      }
   \right)
}{\Delta x_{\pic}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[T \dder{\uy \dintrpu{T}{y}}{y}
=
\vat{
   T
}{\pic, \pjc}
\frac{
   \vat{\uy}{\pic, \pjp}
   \frac{
      \vat{T}{\pic, \pjpp}
      +
      \vat{T}{\pic, \pjc }
   }{2}
   -
   \vat{\uy}{\pic, \pjm}
   \frac{
      \vat{T}{\pic, \pjc }
      +
      \vat{T}{\pic, \pjmm}
   }{2}
}{\Delta y},\]</div>
<p>where small letters <span class="math notranslate nohighlight">\(c\)</span> are coefficients to be determined.</p>
<p>In order to keep the net amount of <span class="math notranslate nohighlight">\(h\)</span>, we enforce them to be conservative.
The second part yields</p>
<div class="math notranslate nohighlight">
\[\dder{\uy q_y}{y}
+
\frac{
   \vat{T^2}{\pic, \pjc}
}{2}
\dder{\uy}{y},\]</div>
<p>where <span class="math notranslate nohighlight">\(q_y\)</span> is the quadratic quantity, defined as the product of the surrounding <span class="math notranslate nohighlight">\(T\)</span> at cell faces where <span class="math notranslate nohighlight">\(\uy\)</span> are located, e.g.,</p>
<div class="math notranslate nohighlight">
\[\vat{q_y}{\pip, \pjc}
\equiv
\frac{1}{2}
\vat{T}{\pic,  \pjc}
\vat{T}{\pipp, \pjc}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \pip, \pjc \right)\)</span>.
Since the first term is in a conservative form, the volume integral vanishes, while the second part is the residual, which is generally non-zero.</p>
<p>Similarly, the first part can be decomposed to two terms.</p>
<ol class="arabic">
<li><p>Quadratic quantity</p>
<p>The bluish terms consist of the other quadratic quantity <span class="math notranslate nohighlight">\(q_x\)</span> and should be in a conservative form.
To be so, we request two coefficients <span class="math notranslate nohighlight">\(\vat{c^+}{\pipp}\)</span> and <span class="math notranslate nohighlight">\(\vat{c^-}{\pimm}\)</span> to be <span class="math notranslate nohighlight">\(1/2\)</span>.</p>
</li>
<li><p>Residual</p>
<p>The second part leads</p>
<div class="math notranslate nohighlight">
\[\vat{T^2}{\pic, \pjc}
\frac{
   \vat{c^+}{\pic }
   \vat{\ux}{\pim, \pjc}
   -
   \vat{c^-}{\pic }
   \vat{\ux}{\pim, \pjc}
}{\Delta x_{\pic}}\]</div>
<p>This should be canceled out with the other residual</p>
<div class="math notranslate nohighlight">
\[\frac{
   \vat{T^2}{\pic, \pjc}
}{2}
\dder{\uy}{y},\]</div>
<p>requesting two coefficients <span class="math notranslate nohighlight">\(\vat{c^+}{\pic }\)</span> and <span class="math notranslate nohighlight">\(\vat{c^-}{\pic }\)</span> to be <span class="math notranslate nohighlight">\(1/2\)</span>, so that the summation of two vanishes thanks to the incompressibility constraint.</p>
</li>
</ol>
<p>In conclusion, all coefficients are <span class="math notranslate nohighlight">\(1/2\)</span> and thus we find <span class="math notranslate nohighlight">\(\dintrpu{T}{x}\)</span> is an arithmetic average <span class="math notranslate nohighlight">\(\dintrpa{T}{x}\)</span>.
Finally we obtain the advective terms in divergence form:</p>
<div class="math notranslate nohighlight">
\[\dder{\ux T}{x}
+
\dder{\uy T}{y}
=
\color{red}{
   \dder{
      \ux
      \dintrpa{T}{x}
   }{x}
   +
   \dder{
      \uy
      \dintrpa{T}{y}
   }{y}
}\]</div>
<p>defined at cell center <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span>.</p>
</details></section>
<section id="gradient-form-of-advective-terms">
<h4>3. Gradient form of advective terms<a class="headerlink" href="#gradient-form-of-advective-terms" title="Permalink to this heading">¶</a></h4>
<p>We find that the advective terms can also be written as</p>
<div class="math notranslate nohighlight">
\[\dintrpv{
   \ux
   \dder{T}{x}
}{x}
+
\dintrpa{
   \uy
   \dder{T}{y}
}{y}.\]</div>
<details>
<summary>
Derivations</summary><p>Being analogous to the momentum advections, the divergence and gradient forms should be identical to each other via the incompressibility constraint, i.e.,</p>
<div class="math notranslate nohighlight">
\[u_i \dder{T}{x_i}
=
\dder{u_i T}{x_i}
-
T \dder{u_i}{x_i},\]</div>
<p>which is defined at cell center <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span>.</p>
<p>Being different from the advective terms in the momentum balance, we do not have to interpolate the incompressibility constraint since it is located at the same position as the temperature.
Thus the gradient form leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ux \dder{T}{x}
&amp; =
\dder{\ux T}{x}
-
T \dder{\ux}{x} \\
&amp; =
\dder{
   \ux
   \dintrpa{T}{x}
}{x}
- T \dder{
   \ux
}{x} \\
&amp; =
\frac{
   \vat{\ux}{\pip, \pjc}
   \frac{
      \vat{T}{\pipp, \pjc}
      +
      \vat{T}{\pic,  \pjc}
   }{2}
   -
   \vat{\ux}{\pim, \pjc}
   \frac{
      \vat{T}{\pic,  \pjc}
      +
      \vat{T}{\pimm, \pjc}
   }{2}
}{\Delta x_{\pic}}
-
\vat{T}{\pic, \pjc} \frac{
   \vat{\ux}{\pip, \pjc}
   -
   \vat{\ux}{\pim, \pjc}
}{\Delta x_{\pic}} \\
&amp; =
\vat{\ux}{\pip, \pjc}
\frac{1}{\Delta x_{\pic}}
\frac{
   \vat{
      \diffe{T}{x}
   }{\pip, \pjc}
}{2}
+
\vat{\ux}{\pim, \pjc}
\frac{1}{\Delta x_{\pic}}
\frac{
   \vat{
      \diffe{T}{x}
   }{\pim, \pjc}
}{2} \\
&amp; =
\frac{\Delta x_{\pip}}{2 \Delta x_{\pic}} \vat{
   \left(
      \ux
      \dder{T}{x}
   \right)
}{\pip, \pjc}
+
\frac{\Delta x_{\pim}}{2 \Delta x_{\pic}} \vat{
   \left(
      \ux
      \dder{T}{x}
   \right)
}{\pim, \pjc} \\
&amp; =
\vat{C}{\pip} \vat{
   \left(
      \ux
      \dder{T}{x}
   \right)
}{\pip, \pjc}
+
\vat{C}{\pim} \vat{
   \left(
      \ux
      \dder{T}{x}
   \right)
}{\pim, \pjc} \\
&amp; =
\color{red}{
   \vat{
      \dintrpv{
         \ux
         \dder{T}{x}
      }{x}
   }{\pic, \pjc}
}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\uy \dder{T}{y}
&amp; =
\dder{\uy T}{y}
-
T \dder{\uy}{y} \\
&amp; =
\dder{
   \uy
   \dintrpa{T}{y}
}{y}
- T \dder{
   \uy
}{y} \\
&amp; =
\frac{
   \vat{\uy}{\pic, \pjp}
   \frac{
      \vat{T}{\pic, \pjpp}
      +
      \vat{T}{\pic, \pjc}
   }{2}
   -
   \vat{\uy}{\pic, \pjm}
   \frac{
      \vat{T}{\pic, \pjc}
      +
      \vat{T}{\pic, \pjmm}
   }{2}
}{\Delta y}
-
\vat{T}{\pic, \pjc} \frac{
   \vat{\uy}{\pic, \pjp}
   -
   \vat{\uy}{\pic, \pjm}
}{\Delta y} \\
&amp; =
\vat{\uy}{\pic, \pjp}
\frac{1}{\Delta y}
\frac{
   \vat{
      \diffe{T}{y}
   }{\pic, \pjp}
}{2}
+
\vat{\uy}{\pic, \pjm}
\frac{1}{\Delta y}
\frac{
   \vat{
      \diffe{T}{y}
   }{\pic, \pjm}
}{2} \\
&amp; =
\frac{1}{2} \vat{
   \left(
      \uy
      \dder{T}{y}
   \right)
}{\pic, \pjp}
+
\frac{1}{2} \vat{
   \left(
      \uy
      \dder{T}{y}
   \right)
}{\pic, \pjm} \\
&amp; =
\color{red}{
   \vat{
      \dintrpa{
         \uy
         \dder{T}{y}
      }{y}
   }{\pic, \pjc}
}.\end{split}\]</div>
</details></section>
</section>
<section id="diffusive-terms">
<h3>Diffusive terms<a class="headerlink" href="#diffusive-terms" title="Permalink to this heading">¶</a></h3>
<p>These terms <em>diffuse</em> the thermal energy in all directions.
Also, they play a crucial role to (diffuse and) <em>dissipate</em> <span class="math notranslate nohighlight">\(h\)</span>.
In this project, all injection via heating on the walls should be eventually dissipated by them.</p>
<section id="diffusion-of-t">
<h4>1. Diffusion of <span class="math notranslate nohighlight">\(T\)</span><a class="headerlink" href="#diffusion-of-t" title="Permalink to this heading">¶</a></h4>
<p>Since they are linear (and thus we can treat them implicitly in time, see <a class="reference internal" href="../../temporal_discretisation/index.html#temporal-discretisation"><span class="std std-ref">the temporal discretisation</span></a>), we can simply discretise them as</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left\{
   \dder{}{x} \left( \dder{T}{x} \right)
   +
   \dder{}{y} \left( \dder{T}{y} \right)
\right\}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span> where <span class="math notranslate nohighlight">\(T\)</span> is defined.
All first-order differentiations are defined where needed and thus no interpolation is necessary.</p>
</section>
<section id="dissipation-of-h">
<h4>2. Dissipation of <span class="math notranslate nohighlight">\(h\)</span><a class="headerlink" href="#dissipation-of-h" title="Permalink to this heading">¶</a></h4>
<p>Discrete form of <span class="math notranslate nohighlight">\(\der{T}{x_i} \der{T}{x_i}\)</span>, which are used to compute the dissipation rate of the thermal energy, are discretised, which are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( \der{T}{x} \right)^2
+
\left( \der{T}{y} \right)^2
&amp; \approx
r_x r_x
+
r_y r_y \\
&amp; \equiv
\vat{C}{\pip}
\frac{1}{\Delta x_{\pic}}
\vat{
   \diffe{T}{x}
}{\pip, \pjc}
\vat{
   \dder{T}{x}
}{\pip, \pjc}
+
\vat{C}{\pim}
\frac{1}{\Delta x_{\pic}}
\vat{
   \diffe{T}{x}
}{\pim, \pjc}
\vat{
   \dder{T}{x}
}{\pim, \pjc} \\
&amp; +
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{T}{y}
}{\pic, \pjp}
\vat{
   \dder{T}{y}
}{\pic, \pjp}
+
\frac{1}{2}
\frac{1}{\Delta y}
\vat{
   \diffe{T}{y}
}{\pic, \pjm}
\vat{
   \dder{T}{y}
}{\pic, \pjm}\end{split}\]</div>
<p>at <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span>.</p>
<details>
<summary>
Derivations</summary><p>In <a class="reference internal" href="../../../governing_equations/index.html#governing-equations"><span class="std std-ref">the governing equations</span></a> (for continuous domain), we multiplied <span class="math notranslate nohighlight">\(T\)</span> and the equation of internal energy balance to derive the relation of the diffusion and dissipation of <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="math notranslate nohighlight">
\[T \der{}{x_i} \left( \der{T}{x_i} \right)
=
\der{}{x_i} \left( T \der{T}{x_i} \right)
-
\der{T}{x_i} \der{T}{x_i},\]</div>
<p>where pre-factors <span class="math notranslate nohighlight">\(1 / \sqrt{Pr} \sqrt{Ra}\)</span> are dropped for convenience.
Here we consider the counterpart in the discrete space.</p>
<p>It is readily apparent that the left-hand-side is</p>
<div class="math notranslate nohighlight">
\[\begin{split}T
\left\{
   \dder{}{x} \left( \dder{T}{x} \right)
   +
   \dder{}{y} \left( \dder{T}{y} \right)
\right\}
&amp; =
\frac{
   \vat{T}{\pic, \pjc}
   \vat{
      \dder{T}{x}
   }{\pip, \pjc}
   -
   \vat{T}{\pic, \pjc}
   \vat{
      \dder{T}{x}
   }{\pim, \pjc}
}{\Delta x_{\pic}} \\
&amp; +
\frac{
   \vat{T}{\pic, \pjc}
   \vat{
      \dder{T}{y}
   }{\pic, \pjp}
   -
   \vat{T}{\pic, \pjc}
   \vat{
      \dder{T}{y}
   }{\pic, \pjm}
}{\Delta y},\end{split}\]</div>
<p>while the first term in the right-hand-side (diffusion of <span class="math notranslate nohighlight">\(h\)</span>) leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\dder{}{x} \left( T \dder{T}{x} \right)
+
\dder{}{y} \left( T \dder{T}{y} \right)
&amp; =
\frac{
   \vat{
      \dintrpa{T}{x}
   }{\pip, \pjc}
   \vat{
      \dder{T}{x}
   }{\pip, \pjc}
   -
   \vat{
      \dintrpa{T}{x}
   }{\pim, \pjc}
   \vat{
      \dder{T}{x}
   }{\pim, \pjc}
}{\Delta x_{\pic}} \\
&amp; +
\frac{
   \vat{
      \dintrpa{T}{y}
   }{\pic, \pjp}
   \vat{
      \dder{T}{y}
   }{\pic, \pjp}
   -
   \vat{
      \dintrpa{T}{y}
   }{\pic, \pjm}
   \vat{
      \dder{T}{y}
   }{\pic, \pjm}
}{\Delta y}.\end{split}\]</div>
<p>Subtracting the first equation from the second one yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\frac{
   \left(
      \vat{
         \dintrpa{T}{x}
      }{\pip, \pjc}
      -
      \vat{T}{\pic, \pjc}
   \right)
   \vat{
      \dder{T}{x}
   }{\pip, \pjc}
   -
   \left(
      \vat{
         \dintrpa{T}{x}
      }{\pim, \pjc}
      -
      \vat{T}{\pic, \pjc}
   \right)
   \vat{
      \dder{T}{x}
   }{\pim, \pjc}
}{\Delta x_{\pic}} \\
+ &amp;
\frac{
   \left(
      \vat{
         \dintrpa{T}{y}
      }{\pic, \pjp}
      -
      \vat{T}{\pic, \pjc}
   \right)
   \vat{
      \dder{T}{y}
   }{\pic, \pjp}
   -
   \left(
      \vat{
         \dintrpa{T}{y}
      }{\pic, \pjm}
      -
      \vat{T}{\pic, \pjc}
   \right)
   \vat{
      \dder{T}{y}
   }{\pic, \pjm}
}{\Delta y} \\
= &amp;
\color{red}{
   \vat{C}{\pip}
   \frac{1}{\Delta x_{\pic}}
   \vat{
      \diffe{T}{x}
   }{\pip, \pjc}
   \vat{
      \dder{T}{x}
   }{\pip, \pjc}
   +
   \vat{C}{\pim}
   \frac{1}{\Delta x_{\pic}}
   \vat{
      \diffe{T}{x}
   }{\pim, \pjc}
   \vat{
      \dder{T}{x}
   }{\pim, \pjc}
} \\
\color{red}{+} &amp;
\color{red}{
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{T}{y}
   }{\pic, \pjp}
   \vat{
      \dder{T}{y}
   }{\pic, \pjp}
   +
   \frac{1}{2}
   \frac{1}{\Delta y}
   \vat{
      \diffe{T}{y}
   }{\pic, \pjm}
   \vat{
      \dder{T}{y}
   }{\pic, \pjm}
},\end{split}\]</div>
<p>whose reddish part is computed in <a class="reference internal" href="../../../implementation/analyses.html#analyses"><span class="std std-ref">analyses_compute_thermal_dissipation</span></a>, since this quantity has a direct relation with the dissipation rate of the thermal energy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(\vat{C}{\pip}, \vat{C}{\pim}\)</span> are coefficients</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\vat{C}{\pip}
=
\begin{cases}
   \pip \text{is right wall} &amp; 1 \\
   \text{otherwise}          &amp; \frac{1}{2}
\end{cases}, \\
&amp;
\vat{C}{\pim}
=
\begin{cases}
   \pim \text{is left wall} &amp; 1 \\
   \text{otherwise}         &amp; \frac{1}{2}
\end{cases},\end{split}\]</div>
<p>to reflect the boundary corrections.</p>
<p>If the boundary effects are neglected, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;
\frac{\Delta x_{\pip}}{2 \Delta x_{\pic}}
\left(
   \vat{
      \dder{T}{x}
   }{\pip, \pjc}
\right)^2
+
\frac{\Delta x_{\pim}}{2 \Delta x_{\pic}}
\left(
   \vat{
      \dder{T}{x}
   }{\pim, \pjc}
\right)^2 \\
+ &amp;
\frac{1}{2}
\left(
   \vat{
      \dder{T}{y}
   }{\pic, \pjp}
\right)^2
+
\frac{1}{2}
\left(
   \vat{
      \dder{T}{y}
   }{\pic, \pjm}
\right)^2 \\
= &amp;
\dintrpv{
   \left(
      \dder{T}{x}
   \right)^2
}{x}
+
\dintrpa{
   \left(
      \dder{T}{y}
   \right)^2
}{y}.\end{split}\]</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A more intuitive way to discretise <span class="math notranslate nohighlight">\(\der{T}{y}\)</span> at <span class="math notranslate nohighlight">\(\left( \pic, \pjc \right)\)</span> might be</p>
<div class="math notranslate nohighlight">
\[\frac{
   \vat{T}{\pic, \pjpp}
   -
   \vat{T}{\pic, \pjmm}
}{2 \Delta y},\]</div>
<p>and a similar way in <span class="math notranslate nohighlight">\(x\)</span> direction.</p>
<p>This is clearly different from what was derived in this section, and as a result the energy consistency is broken.
In particular, the dissipation is <em>underestimated</em> since high-frequency signals are smoothened by using a wider stencil.</p>
</div>
</details></section>
</section>
</section>
<section id="derivations-global-conservations">
<h2>Derivations - global conservations<a class="headerlink" href="#derivations-global-conservations" title="Permalink to this heading">¶</a></h2>
<p>In this part, we analyse the <em>global</em> properties of equations averaged in the whole volume, which plays a crucial role when we discuss <a class="reference internal" href="nusselt_number_relations.html#nusselt-number-relations"><span class="std std-ref">the energy balance of Rayleigh-Bénard convections</span></a>.</p>
<p>Following the above discussion, the evolution of <span class="math notranslate nohighlight">\(h \equiv \frac{1}{2} T^2\)</span> leads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\der{}{t} \left( \frac{1}{2} T^2 \right)
&amp; +
\dder{\ux q_x}{x}
+
\dder{\uy q_y}{y} \\
&amp; =
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left\{
   \dder{}{x} \left( T \dder{T}{x} \right)
   +
   \dder{}{y} \left( T \dder{T}{y} \right)
\right\}
-
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left(
   r_x r_x
   +
   r_y r_y
\right).\end{split}\]</div>
<p>Now we consider to integrate these equations in the whole volume to deduce the evolution of <span class="math notranslate nohighlight">\(H\)</span>:</p>
<div class="math notranslate nohighlight">
\[H
\equiv
\sum_{i} \sum_{j}
\vat{
   \left(
      h
      \Delta x
      \Delta y
   \right)
}{\pic, \pjc}
=
\sum_{i} \sum_{j}
\vat{
   \left(
      \frac{1}{2} T^2 \Delta x \Delta y
   \right)
}{\pic, \pjc}.\]</div>
<p>As usual, conservative terms vanish except</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{Pr} \sqrt{Ra}}
\der{}{x} \left( T \der{T}{x} \right),\]</div>
<p>whose volume integral leads</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \sum_{j}
\vat{
   \left\{
      \frac{1}{\sqrt{Pr} \sqrt{Ra}}
      \dder{}{x} \left( T \dder{T}{x} \right)
      \Delta x
      \Delta y
   \right\}
}{\pic, \pjc}
=
\sum_{j}
\vat{
   \left\{
      \frac{1}{\sqrt{Pr} \sqrt{Ra}}
      \left[ T \dder{T}{x} \right]_{\text{left wall}}^{\text{right wall}}
      \Delta y
   \right\}
}{\pjc}.\]</div>
<p>As a result, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\der{H}{t}
&amp; \equiv
\der{}{t} \sum_{i} \sum_{j}
\vat{
   \left(
      \frac{1}{2} T^2 \Delta x \Delta y
   \right)
}{\pic, \pjc} \\
&amp; =
\sum_{j}
\vat{
   \left\{
      \frac{1}{\sqrt{Pr} \sqrt{Ra}}
      \left[ T \dder{T}{x} \right]_{\text{left wall}}^{\text{right wall}}
      \Delta y
   \right\}
}{\pjc} \\
&amp; -
\sum_{i} \sum_{j}
\vat{
   \left\{
      \frac{1}{\sqrt{Pr} \sqrt{Ra}} \left(
         r_x r_x
         +
         r_y r_y
      \right)
      \Delta x
      \Delta y
   \right\}
}{\pic, \pjc}.\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a statistically-steady state where the temporal dependencies vanish, we find that the energy injection by the heat fluxes on the walls are balanced by the thermal dissipation.</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Naoki Hori.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/numerical_method/spatial_discretisation/discrete_governing_equations/thermal_energy_balance_and_quadratic_quantity.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>