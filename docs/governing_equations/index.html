
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Governing equations &#8212; Simple Navier-Stokes Solver 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"der": ["{\\frac{\\partial #1}{\\partial #2}}", 2], "dder": ["{\\frac{\\delta #1}{\\delta #2}}", 2], "mst": ["{\\gamma^{#1 #2}}", 2], "gx": ["{\\xi}"], "gy": ["{\\eta}"], "ux": ["{u_x}"], "uy": ["{u_y}"], "intrp": ["{\\overline{#1}^{#2}}", 2], "diffe": ["{\\delta_{#2} {#1}}", 2], "vat": ["{\\left. {#1} \\right|_{#2}}", 2], "ave": ["{\\left\\langle {#1} \\right\\rangle_{#2}}", 2], "pimm": ["i-1           "], "pim": ["i-\\frac{1}{2}"], "pic": ["i             "], "pip": ["i+\\frac{1}{2}"], "pipp": ["i+1           "], "pjmm": ["j-1           "], "pjm": ["j-\\frac{1}{2}"], "pjc": ["j             "], "pjp": ["j+\\frac{1}{2}"], "pjpp": ["j+1           "], "ximm": ["i-\\frac{1}{2}"], "xim": ["i             "], "xic": ["i+\\frac{1}{2}"], "xip": ["i+1           "], "xipp": ["i+\\frac{3}{2}"], "xjmm": ["j-1           "], "xjm": ["j-\\frac{1}{2}"], "xjc": ["j             "], "xjp": ["j+\\frac{1}{2}"], "xjpp": ["j+1           "], "yimm": ["i-1           "], "yim": ["i-\\frac{1}{2}"], "yic": ["i             "], "yip": ["i+\\frac{1}{2}"], "yipp": ["i+1           "], "yjmm": ["j-\\frac{1}{2}"], "yjm": ["j             "], "yjc": ["j+\\frac{1}{2}"], "yjp": ["j+1           "], "yjpp": ["j+\\frac{3}{2}"], "dintrpa": ["{\\overline{#1}^{#2}}", 2], "dintrpv": ["{\\widehat {#1}^{#2}}", 2], "dintrpu": ["{\\widetilde {#1}^{#2}}", 2]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numerical method" href="../numerical_method/index.html" />
    <link rel="prev" title="Introduction" href="../introduction.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Simple Navier-Stokes Solver</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NaokiHori&repo=SimpleNavierStokesSolver&type=true&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Governing equations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dimensional-forms">Dimensional forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#non-dimensional-forms">Non-dimensional forms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../numerical_method/index.html">Numerical method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementation/index.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../introduction.html" title="previous chapter">Introduction</a></li>
      <li>Next: <a href="../numerical_method/index.html" title="next chapter">Numerical method</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="governing-equations">
<span id="id1"></span><h1>Governing equations<a class="headerlink" href="#governing-equations" title="Permalink to this heading">¶</a></h1>
<section id="dimensional-forms">
<h2>Dimensional forms<a class="headerlink" href="#dimensional-forms" title="Permalink to this heading">¶</a></h2>
<p>In this project, we focus on the balance of these quantities (conservation laws):</p>
<blockquote>
<div><ul class="simple">
<li><p>mass (incompressibility constraint),</p></li>
<li><p>momentum (<span class="math notranslate nohighlight">\(u_i\)</span>, per unit mass, omitted hereafter),</p></li>
<li><p>kinetic energy (<span class="math notranslate nohighlight">\(k \equiv u_i u_i / 2\)</span>),</p></li>
<li><p>internal energy (temperature <span class="math notranslate nohighlight">\(T\)</span>),</p></li>
<li><p>thermal analogue to the kinetic energy (<span class="math notranslate nohighlight">\(h \equiv T^2 / 2\)</span>).</p></li>
</ul>
</div></blockquote>
<p>After being simplified, governing equations for these quantities lead</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
   \begin{alignedat}{2}
      &amp; \der{u_i}{x_i} = 0, \\
      &amp; \der{u_i}{t} + u_j \der{u_i}{x_j} = -\der{p}{x_i} + \nu \frac{\partial^2 u_i}{\partial x_j \partial x_j} + f_i, \\
      &amp; \der{k}{t} + u_i \der{k}{x_i} = -u_i \der{p}{x_i} + \nu \der{}{x_j} \left( u_i \der{u_i}{x_j} \right) - \nu \der{u_i}{x_j} \der{u_i}{x_j} + u_i f_i, \\
      &amp; \der{T}{t} + u_i \der{T}{x_i} = \kappa \frac{\partial^2 T}{\partial x_i \partial x_i}, \\
      &amp; \der{h}{t} + u_i \der{h}{x_i} = \kappa \der{}{x_i} \left( T \der{T}{x_i} \right) - \kappa \der{T}{x_i} \der{T}{x_i},
   \end{alignedat}
\right.\end{split}\]</div>
<p>where constant physical properties in time and space (e.g., density <span class="math notranslate nohighlight">\(\rho\)</span>, kinematic viscosity <span class="math notranslate nohighlight">\(\nu\)</span>, thermal diffusivity <span class="math notranslate nohighlight">\(\kappa\)</span>) are assumed.</p>
<p>Derivations are as follows.</p>
<details id="mass">
<summary>
mass</summary><p>By assuming no generation nor loss, mass balance of a control volume <span class="math notranslate nohighlight">\(V\)</span> (whose surface is <span class="math notranslate nohighlight">\(\partial V\)</span> or <span class="math notranslate nohighlight">\(S\)</span>, and its normal is given by <span class="math notranslate nohighlight">\(n_i\)</span>) can be written as</p>
<div class="math notranslate nohighlight">
\[\der{}{t} \int_{V} \rho dV + \int_{\partial V} \rho u_i n_i dS = 0,\]</div>
<p>indicating that the mass increase or decrease in time is balanced by the mass flux.
Here <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(u_i\)</span> denote the density of the liquid and velocity, which are generally functions of space <span class="math notranslate nohighlight">\(x_i\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>.
Commutation between the temporal derivative and the integral gives</p>
<div class="math notranslate nohighlight">
\[\int_{V} \der{\rho}{t} dV + \int_{\partial V} \rho u_i n_i dS = 0.\]</div>
<p>By applying Gauss theorem, we have</p>
<div class="math notranslate nohighlight">
\[\int_{V} \left( \der{\rho}{t} + \der{\rho u_i}{x_i} \right) dV = 0.\]</div>
<p>Since this relation should be satisfied anywhere (arbitrary control volume), the integrand should be null, i.e.,</p>
<div class="math notranslate nohighlight">
\[\der{\rho}{t} + \der{\rho u_i}{x_i} = 0.\]</div>
<p>In this project, we assume that the liquid is incompressible</p>
<div class="math notranslate nohighlight">
\[\frac{D \rho}{D t}
\equiv
\der{\rho}{t} + u_i \der{\rho}{x_i}
=
0,\]</div>
<p>which further simplifies the above equation and results in the incompressibility constraint</p>
<div class="math notranslate nohighlight">
\[\der{u_i}{x_i} = 0.\]</div>
</details><details id="momentum">
<summary>
momentum</summary><p>Based on the same discussion as <a class="reference internal" href="#mass"><span class="std std-ref">the mass balance</span></a>, momentum balance can be written as</p>
<div class="math notranslate nohighlight">
\[\int_{V} \left( \der{\rho u_i}{t} + u_j \der{\rho u_i}{x_j} \right) dV
=
\int_{\partial V} \sigma_{ij} n_j dS
+
\int_{V} f_i dV,\]</div>
<p>indicating that changes in the momentum are caused by the 1. advection, 2. force working on the surface (both normal and tangential to the surface), and 3. body force.</p>
<p>Again, thanks to the divergence theorem, we have</p>
<div class="math notranslate nohighlight">
\[\der{\rho u_i}{t} + u_j \der{\rho u_i}{x_j}
=
\der{\sigma_{ij}}{x_j}
+
f_i.\]</div>
<p>In particular, <span class="math notranslate nohighlight">\(\sigma_{ij}\)</span> is the Cauchy stress tensor given as (assuming incompressible liquid)</p>
<div class="math notranslate nohighlight">
\[\sigma_{ij} = - p \delta_{ij} + 2 \mu e_{ij},\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> is the reduced pressure and <span class="math notranslate nohighlight">\(e_{ij}\)</span> is the strain-rate tensor (assuming isotropic Newtonian liquid)</p>
<div class="math notranslate nohighlight">
\[e_{ij} = \frac{1}{2} \left( \der{u_i}{x_j} + \der{u_j}{x_i} \right).\]</div>
<p>Based on this closure relation, we obtain the balance of momentum as</p>
<div class="math notranslate nohighlight">
\[\der{\rho u_i}{t} + u_j \der{\rho u_i}{x_j}
=
-
\der{p}{x_i}
+
\der{}{x_j} \left( 2 \mu e_{ij} \right)
+
f_i.\]</div>
<p>Finally, by assuming the density and viscosity are constant, we have</p>
<div class="math notranslate nohighlight">
\[\der{u_i}{t}
+ u_j \der{u_i}{x_j}
= -\der{p}{x_i}
+ \nu \frac{\partial^2 u_i}{\partial x_j \partial x_j}
+ f_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu \equiv \mu / \rho\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Navier–Stokes_equations">Navier-Stokes equations</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Newtonian_fluid">Newtonian fluid</a></p></li>
</ul>
</div>
</details><details>
<summary>
kinetic energy</summary><p>As discussed in the derivation of <a class="reference internal" href="#momentum"><span class="std std-ref">the momentum balance</span></a>, we have the following relation</p>
<div class="math notranslate nohighlight">
\[\der{u_i}{t}
+ u_j \der{u_i}{x_j}
= -\der{p}{x_i}
+ \nu \frac{\partial^2 u_i}{\partial x_j \partial x_j}
+ f_i.\]</div>
<p>We consider to multiply the momentum balance by <span class="math notranslate nohighlight">\(u_i\)</span>, i.e., calculating the inner product of each term with <span class="math notranslate nohighlight">\(u_i\)</span>.
By adopting the product rule, it is readily apparent that we have</p>
<div class="math notranslate nohighlight">
\[\der{k}{t}
+ u_i \der{k}{x_i}
= -u_i \der{p}{x_i}
+ \nu \der{}{x_j} \left( u_i \der{u_i}{x_j} \right)
- \nu \der{u_i}{x_j} \der{u_i}{x_j}
+ u_i f_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(k \equiv \frac{1}{2} u_i u_i\)</span> is the kinetic energy per unit mass.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The second term in the right-hand-side can be written as</p>
<div class="math notranslate nohighlight">
\[\nu \frac{\partial^2 k}{\partial x_i \partial x_i}\]</div>
<p>by further using the product rule.
However, we stop in the first formulation for later convenience.</p>
</div>
</details><details>
<summary>
internal energy (temperature) and thermal analogue to the kinetic energy</summary><p>By following the identical procedure as <a class="reference internal" href="#momentum"><span class="std std-ref">the momentum balance</span></a> (substituting <span class="math notranslate nohighlight">\(u_i\)</span> with <span class="math notranslate nohighlight">\(T\)</span>), we can derive the balance of the internal energy (or temperature):</p>
<div class="math notranslate nohighlight">
\[\der{T}{t}
+ u_i \der{T}{x_i}
= \kappa \frac{\partial^2 T}{\partial x_i \partial x_i}.\]</div>
<p>Also, by multiplying this equation by <span class="math notranslate nohighlight">\(T\)</span>, we obtain</p>
<div class="math notranslate nohighlight">
\[\der{h}{t}
+ u_i \der{h}{x_i}
= \kappa \der{}{x_i} \left( T \der{T}{x_i} \right)
- \kappa \der{T}{x_i} \der{T}{x_i},\]</div>
<p>where <span class="math notranslate nohighlight">\(h \equiv \frac{1}{2} T^2\)</span> is analogous to the kinetic energy per unit mass <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The second term in the right-hand-side can be written as</p>
<div class="math notranslate nohighlight">
\[\kappa \frac{\partial^2 h}{\partial x_i \partial x_i}\]</div>
<p>by further using the product rule.
However, we stop in the first formulation for later convenience.</p>
</div>
</details></section>
<section id="non-dimensional-forms">
<h2>Non-dimensional forms<a class="headerlink" href="#non-dimensional-forms" title="Permalink to this heading">¶</a></h2>
<p>We focus on <a class="reference external" href="https://en.wikipedia.org/wiki/Rayleigh–Bénard_convection">Rayleigh-Bénard convections</a> in this project, which is an excellent model problem to shed light on the conservation properties.
By assuming <a class="reference external" href="https://en.wikipedia.org/wiki/Boussinesq_approximation_(buoyancy)">Boussinesq approximation</a> to make the above equations non-dimensional, we obtain a set of equations which are considered in this project:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
   \begin{alignedat}{2}
      &amp; \der{u_i}{x_i} = 0, \\
      &amp; \der{u_i}{t} + u_j \der{u_i}{x_j} = -\der{p}{x_i} + \frac{\sqrt{Pr}}{\sqrt{Ra}} \frac{\partial^2 u_i}{\partial x_j \partial x_j} + T \delta_{ix}, \\
      &amp; \der{k}{t} + u_i \der{k}{x_i} = -u_i \der{p}{x_i} + \frac{\sqrt{Pr}}{\sqrt{Ra}} \der{}{x_j} \left( u_i \der{u_i}{x_j} \right) - \frac{\sqrt{Pr}}{\sqrt{Ra}} \der{u_i}{x_j} \der{u_i}{x_j} + u_i T \delta_{ix}, \\
      &amp; \der{T}{t} + u_i \der{T}{x_i} = \frac{1}{\sqrt{Pr} \sqrt{Ra}} \frac{\partial^2 T}{\partial x_i \partial x_i}, \\
      &amp; \der{h}{t} + u_i \der{h}{x_i} = \frac{1}{\sqrt{Pr} \sqrt{Ra}} \der{}{x_i} \left( T \der{T}{x_i} \right)
                                      - \frac{1}{\sqrt{Pr} \sqrt{Ra}} \der{T}{x_i} \der{T}{x_i}
   \end{alignedat}
\right.\end{split}\]</div>
<p>where Rayleigh number <span class="math notranslate nohighlight">\(Ra\)</span> and Prandtl number <span class="math notranslate nohighlight">\(Pr\)</span> are non-dimensional parameters which are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  Ra &amp; = \frac{\beta g {l_x}^3 \left( \Delta T \right)}{\nu \kappa}, \\
  Pr &amp; = \frac{\nu}{\kappa}.
\end{aligned}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, <span class="math notranslate nohighlight">\(l_x\)</span>, and <span class="math notranslate nohighlight">\(\left( \Delta T \right) = T_{H} - T_{L}\)</span> are thermal expansion coefficient <span class="math notranslate nohighlight">\(\left[ K^{-1} \right]\)</span>, gravitational acceleration <span class="math notranslate nohighlight">\(\left[ L T^{-2} \right]\)</span>, distance between the walls <span class="math notranslate nohighlight">\(\left[ L \right]\)</span>, and temperature difference <span class="math notranslate nohighlight">\(\left[ K \right]\)</span>, respectively.
Also see the schematic below for convenience.</p>
<a class="reference internal image-reference" href="../_images/schematic.pdf"><img alt="../_images/schematic.pdf" src="../_images/schematic.pdf" style="width: 400px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here are several additional things to be noted.</p>
<ol class="arabic simple">
<li><p>Without loss of generality, we can fix <span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, <span class="math notranslate nohighlight">\(l_x\)</span>, and <span class="math notranslate nohighlight">\(\left( \Delta T \right)\)</span> to unity, which is assumed in this project.</p></li>
<li><p>Characteristic velocity <span class="math notranslate nohighlight">\(U \left[ L T^{-1} \right]\)</span> is defined by using the other parameters <span class="math notranslate nohighlight">\(U = \sqrt{\beta g l_x \left( \Delta T \right)} \left( = 1 \right)\)</span>, namely free-fall velocity.</p></li>
<li><p>In this project, <span class="math notranslate nohighlight">\(x\)</span> direction is the wall-normal direction, while other directions <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> are used to denote homogeneous directions where periodic boundary conditions (<span class="math notranslate nohighlight">\(\vat{q}{y = 0} \equiv \vat{q}{y = l_y}\)</span>) are imposed.</p></li>
<li><p>Walls are fixed in space and time. Although it is trivial to let them move in homogeneous directions from a numerical point of view, discussions regarding the energy balance assume fixed walls for the time being.</p></li>
</ol>
</div>
<p>One of the most important features of Rayleigh-Bénard convections is its perfect energy balances and resulting theoretical relations with respect to the Nusselt number <span class="math notranslate nohighlight">\(Nu\)</span>, which measures how much the heat transfer is enhanced by the convection.
Here are four typical relations:</p>
<ol class="arabic">
<li><p>Heat flux</p>
<div class="math notranslate nohighlight">
\[Nu
=
-
\ave{
   \vat{
      \der{T}{x}
   }{x = 0}
}{y,z,t}
=
-
\ave{
   \vat{
      \der{T}{x}
   }{x = l_x}
}{y,z,t},\]</div>
<p>where <span class="math notranslate nohighlight">\(\left\langle q_0 \right\rangle_{q_1}\)</span> indicates the average of a quantity <span class="math notranslate nohighlight">\(q_0\)</span> with respect to <span class="math notranslate nohighlight">\(q_1\)</span></p>
<div class="math notranslate nohighlight">
\[\ave{q_0}{q_1} \equiv \frac{1}{q_1^{\max} - q_1^{\min}} \int_{q_1^{\min}}^{q_0^{\max}} q_0 \, dq_1.\]</div>
<p>Note that this relation is the definition of the Nusselt number and only holds on the walls (at <span class="math notranslate nohighlight">\(x = 0\)</span> and <span class="math notranslate nohighlight">\(l_x\)</span>), but it can be extended to the bulk region:</p>
<div class="math notranslate nohighlight">
\[Nu = Nu \left( x \right)
=
\sqrt{Pr} \sqrt{Ra} \ave{\ux T}{y,z,t} - \ave{\der{T}{x}}{y,z,t}.\]</div>
<details>
<summary>
Derivation</summary><p>Averaging the equation of internal energy (temperature <span class="math notranslate nohighlight">\(T\)</span>) in homogeneous directions (<span class="math notranslate nohighlight">\(y,z\)</span>) and in time gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
   \ave{\der{T}{t}}{y,z,t}
   &amp; +
   \ave{\der{u_i T}{x_i}}{y,z,t} \\
   &amp; =
   \frac{1}{\sqrt{Pr} \sqrt{Ra}} \ave{\frac{\partial^2 T}{\partial x_i \partial x_i}}{y,z,t},
\end{aligned}\end{split}\]</div>
<p>where a conversion from the convective form to the divergence form</p>
<div class="math notranslate nohighlight">
\[u_i \der{q}{x_i} + q \der{u_i}{x_i} = \der{q u_i}{x_i}\]</div>
<p>is adopted with the aid of the incompressiblity constraint.</p>
<p>The temporal evolution drops since we are interested in statistically-steady state.
The advective and diffusive terms in homogeneous directions (e.g., <span class="math notranslate nohighlight">\(\partial u_y T / \partial y\)</span> or <span class="math notranslate nohighlight">\(\partial^2 T / \partial y^2\)</span>) also vanish because of the periodic boundary conditions.
Thus we have</p>
<div class="math notranslate nohighlight">
\[\ave{\der{u_x T}{x}}{y,z,t} = \frac{1}{\sqrt{Pr} \sqrt{Ra}} \ave{\frac{\partial^2 T}{\partial x^2}}{y,z,t}.\]</div>
<p>By further integrating this equation in the wall-normal direction (interval is <span class="math notranslate nohighlight">\(\left[ 0, x \right]\)</span>), we obtain</p>
<div class="math notranslate nohighlight">
\[\sqrt{Pr} \sqrt{Ra} \left[ \ave{u_x T}{y,z,t} \right]_{x = 0}^{x = x}
=
\left[ \ave{\der{T}{x}}{y,z,t} \right]_{x = 0}^{x = x}.\]</div>
<p>We notice</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(-\vat{\ave{u_x T}{y,z,t}}{x = 0} = 0\)</span> since <span class="math notranslate nohighlight">\(\vat{u_x}{x = 0} \equiv 0\)</span> (walls are impermeable)</p></li>
<li><p><span class="math notranslate nohighlight">\(-\vat{\ave{\der{T}{x}}{y,z,t}}{x = 0} = Nu\)</span> because of the definition</p></li>
</ol>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[\forall x \in \left[ 0, l_x \right], \,\,
Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{u_x T}{y,z,t}
-
\ave{\der{T}{x}}{y,z,t}.\]</div>
</details></li>
<li><p>Energy injection</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\ux T}{x,y,z,t} + 1.\]</div>
<details>
<summary>
Derivation</summary><p>By further averaging the relation of the heat flux in the wall-normal direction (or equivalently averaging the equation of the temperature in the whole domain), we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
   \frac{1}{l_x} \int_{x=0}^{x=l_x} Nu dx
   &amp; =
   \frac{1}{l_x} \int_{x=0}^{x=l_x} \left[ \sqrt{Pr} \sqrt{Ra} \ave{u_x T}{y,z,t} - \ave{\der{T}{x}}{y,z,t} \right] dx \\
   &amp; =
   \sqrt{Pr} \sqrt{Ra} \ave{\ux T}{x,y,z,t}
   -
   \frac{1}{l_x} \vat{\ave{T}{y,z,t}}{x=l_x}
   +
   \frac{1}{l_x} \vat{\ave{T}{y,z,t}}{x=  0}.
\end{aligned}\end{split}\]</div>
<p>The left-hand-side is <span class="math notranslate nohighlight">\(Nu\)</span> since <span class="math notranslate nohighlight">\(Nu\)</span> is a constant.
The second and third terms in the right-hand-side are <span class="math notranslate nohighlight">\(-T_{L}\)</span> and <span class="math notranslate nohighlight">\(T_{H}\)</span> respectively because of the boudnary conditions.
Since <span class="math notranslate nohighlight">\(T_{H} - T_{L} \equiv 1\)</span>, we finally have</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\ux T}{x,y,z,t} + 1.\]</div>
</details></li>
<li><p>Kinetic energy dissipation</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\epsilon_k}{V,t} + 1,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\ave{\epsilon_k}{V,t}
=
\ave{\epsilon_k}{x,y,z,t}
=
\frac{\sqrt{Pr}}{\sqrt{Ra}} \ave{\der{u_i}{x_j} \der{u_i}{x_j}}{x,y,z,t}\]</div>
<p>is the volume-averaged kinematic dissipation rate.</p>
<details>
<summary>
Derivation</summary><p>By averaging the equation of the kinetic energy balance <span class="math notranslate nohighlight">\(k\)</span> in time and space, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
   \frac{1}{l_x} \left[ \ave{u_x \left( k + p \right)}{y,z,t} \right]_{x=0}^{x=l_x}
   &amp; =
   \frac{\sqrt{Pr}}{\sqrt{Ra}} \left[ \ave{u_i \der{u_i}{x}}{y,z,t} \right]_{x=0}^{x=l_x} \\
   &amp; -
   \frac{\sqrt{Pr}}{\sqrt{Ra}} \ave{\der{u_i}{x_j} \der{u_i}{x_j}}{x,y,z,t} \\
   &amp; +
   \ave{u_x T}{x,y,z,t},
\end{aligned}\end{split}\]</div>
<p>where terms including derivatives in homogeneous directions have already been eliminated using the periodicities.
The left-hand-side vanishes because of the impermeable condition on the walls <span class="math notranslate nohighlight">\(\vat{u_x}{x=0} = \vat{u_x}{x=l_x} \equiv 0\)</span>.
Written explicitly, the first term in the right-hand-side is</p>
<div class="math notranslate nohighlight">
\[\frac{\sqrt{Pr}}{\sqrt{Ra}} \left[ \ave{u_x \der{u_x}{x} + u_y \der{u_y}{x} + u_z \der{u_z}{x}}{y,z,t} \right]_{x=0}^{x=l_x}.\]</div>
<p>The first term is always null since the walls are impermeable.
Regarding the other terms, they also take null <strong>as long as the walls are at rest</strong>; otherwise they represents (generally) the energy injection by the driving force.
The physical interpretation of this term is the transfer by diffusion, i.e., viscous stress transports the kinetic energy from the walls to the fluid (nothing else but the drag force) since they can be written as</p>
<div class="math notranslate nohighlight">
\[\frac{\sqrt{Pr}}{\sqrt{Ra}} \left[ \ave{\der{k}{x}}{y,z,t} \right]_{x=0}^{x=l_x}.\]</div>
<p>Since we assume the walls are fixed also in the homogeneous directions for now, they all vanish and we have</p>
<div class="math notranslate nohighlight">
\[\ave{u_x T}{x,y,z,t}
=
\frac{\sqrt{Pr}}{\sqrt{Ra}} \ave{\der{u_i}{x_j} \der{u_i}{x_j}}{x,y,z,t}
\equiv
\ave{\epsilon_k}{x,y,z,t},\]</div>
<p>indicating that the energy injection by the buoyancy is compensated for by the dissipation of the energy.
By comparing with the relation of energy injection</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\ux T}{x,y,z,t} + 1,\]</div>
<p>we immediately notice</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\epsilon_k}{x,y,z,t} + 1.\]</div>
</details></li>
<li><p>Thermal energy dissipation</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\epsilon_h}{V,t}.\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\ave{\epsilon_h}{V,t}
=
\ave{\epsilon_h}{x,y,z,t}
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \ave{\der{T}{x_i} \der{T}{x_i}}{x,y,z,t}\]</div>
<p>is the volume-averaged thermal dissipation rate.</p>
<details>
<summary>
Derivation</summary><p>By averaging the equation of <span class="math notranslate nohighlight">\(h = \frac{1}{2} T^2\)</span> in time and space, we have</p>
<div class="math notranslate nohighlight">
\[\frac{1}{l_x} \left[ \ave{u_x h}{y,z,t} \right]_{x=0}^{x=l_x}
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left[ \ave{T \der{T}{x}}{y,z,t} \right]_{x=0}^{x=l_x}
-
\frac{1}{\sqrt{Pr} \sqrt{Ra}} \ave{\der{T}{x_i} \der{T}{x_i}}{x,y,z,t},\]</div>
<p>The left-hand-side vanishes because of the impermeable condition on the walls <span class="math notranslate nohighlight">\(\vat{u_x}{x=0} = \vat{u_x}{x=l_x} \equiv 0\)</span>.
Mote explicit representation of the first term in the right-hand-side leads</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left[ \ave{T \der{T}{x}}{y,z,t} \right]_{x=0}^{x=l_x}.\]</div>
<p>Although things inside brackets look non-linear, we can take out <span class="math notranslate nohighlight">\(T\)</span> being constants on the walls thanks to the boundary conditions, i.e.,</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left(
     T_L \vat{\ave{\der{T}{x}}{y,z,t}}{x=l_x}
   - T_H \vat{\ave{\der{T}{x}}{y,z,t}}{x=  0}
\right),\]</div>
<p>which is, because of the definition of <span class="math notranslate nohighlight">\(Nu\)</span></p>
<div class="math notranslate nohighlight">
\[Nu
=
-\vat{\ave{\der{T}{x}}{y,z,t}}{x =   0}
=
-\vat{\ave{\der{T}{x}}{y,z,t}}{x = l_x},\]</div>
<p>we deduce</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{Pr} \sqrt{Ra}} \left( -T_L Nu + T_H Nu \right)
=
\frac{1}{\sqrt{Pr} \sqrt{Ra}} Nu.\]</div>
<p>It is readily apprent that we finally have</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{Pr}\sqrt{Ra}} Nu
=
\frac{1}{\sqrt{Pr}\sqrt{Ra}} \ave{\der{T}{x_i} \der{T}{x_i}}{x,y,z,t}
\equiv
\ave{\epsilon_h}{x,y,z,t}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[Nu
=
\sqrt{Pr} \sqrt{Ra} \ave{\epsilon_h}{x,y,z,t}.\]</div>
</details></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although pre-factors of the dissipation rates seem to be weird, they remain as they are considering their dimensional counterparts, e.g., <em>dimensional</em> kinematic dissipation rate:</p>
<div class="math notranslate nohighlight">
\[\ave{\epsilon_k}{x,y,z,t} = \nu \ave{\der{u_i}{x_j} \der{u_i}{x_j}}.\]</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>From a numerical point of view, it is non-trivial to satisfy these relations even after being discretised, which is extensively discussed in <a class="reference internal" href="../numerical_method/index.html#numerics"><span class="std std-ref">the numerical method</span></a>.</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Naoki Hori.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/governing_equations/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>